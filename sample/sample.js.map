{
"version":3,
"file":"sample.js",
"sourceRoot":"file:///",
"sources":["/haxe/waud/src/AudioManager.hx","/haxe/waud/src/BaseSound.hx","/haxe/waud/sample/Button.hx","/usr/lib/haxe/std/js/_std/EReg.hx","/haxe/waud/src/HTML5Sound.hx","/usr/lib/haxe/std/js/_std/HxOverrides.hx","/haxe/waud/.haxelib/pixijs/3,0,30/src/pixi/plugins/app/Application.hx","/haxe/waud/sample/Main.hx","/haxe/waud/.haxelib/perf,js/1,1,1/src/Perf.hx","/usr/lib/haxe/std/js/_std/Reflect.hx","/usr/lib/haxe/std/js/_std/Std.hx","/usr/lib/haxe/std/js/_std/Type.hx","/haxe/waud/src/Waud.hx","/haxe/waud/src/WaudFocusManager.hx","/haxe/waud/src/WaudSound.hx","/haxe/waud/src/WaudUtils.hx","/haxe/waud/src/WebAudioAPISound.hx","/usr/lib/haxe/std/haxe/Timer.hx","/usr/lib/haxe/std/js/_std/haxe/ds/StringMap.hx","/usr/lib/haxe/std/js/Boot.hx","/haxe/waud/.haxelib/msignal/1,2,2/msignal/Signal.hx","/haxe/waud/.haxelib/msignal/1,2,2/msignal/Slot.hx","/haxe/waud/.haxelib/msignal/1,2,2/msignal/SlotList.hx"],
"sourcesContent":["import js.html.audio.AudioBufferSourceNode;\nimport js.html.audio.AudioContext;\nimport js.Browser;\n\nclass AudioManager {\n\n\t/**\n\t* Audio Types.\n\t*\n\t* @property types\n\t* @protected\n\t* @type {Map}\n\t*/\n\tpublic var types:Map<String, String>;\n\n\t/**\n\t* Audio Context instance.\n\t*\n\t* @property audioContext\n\t* @protected\n\t* @type {AudioContext}\n\t*/\n\tpublic var audioContext:AudioContext;\n\n\t/**\n\t* Audio buffer list.\n\t*\n\t* @property bufferList\n\t* @protected\n\t* @type {Map}\n\t*/\n\tpublic var bufferList:Map<String, Dynamic>;\n\n\t/**\n\t* Reference to playing sounds.\n\t*\n\t* @property playingSounds\n\t* @protected\n\t* @type {Map}\n\t*/\n\tpublic var playingSounds:Map<String, Dynamic>;\n\n\t/**\n\t* Audio Context Class determined based on the browser type. Refer {{#crossLink \"AudioManager/checkWebAudioAPISupport:method\"}}{{/crossLink}} method.\n\t*\n\t* @property AudioContextClass\n\t* @static\n\t* @private\n\t* @type {AudioContext|webkitAudioContext}\n\t*/\n\tstatic var AudioContextClass:Dynamic;\n\n\t/**\n\t* Audio Manager class instantiated in {{#crossLink \"Waud/init:method\"}}Waud.init{{/crossLink}} method.\n\t*\n\t* @class AudioManager\n\t* @constructor\n\t* @example\n\t* \t\tWaud.audioManager\n\t*/\n\tpublic function new() {\n\t\tbufferList = new Map();\n\t\tplayingSounds = new Map();\n\n\t\ttypes = new Map();\n\t\ttypes.set(\"mp3\", \"audio/mpeg\");\n\t\ttypes.set(\"ogg\", \"audio/ogg\");\n\t\ttypes.set(\"wav\", \"audio/wav\");\n\t\ttypes.set(\"aac\", \"audio/aac\");\n\t\ttypes.set(\"m4a\", \"audio/x-m4a\");\n\t}\n\n\t/**\n\t* Function to check web audio api support.\n\t*\n\t* Used by {{#crossLink \"Waud/init:method\"}}Waud.init{{/crossLink}} method.\n\t*\n\t* @method checkWebAudioAPISupport\n\t*/\n\tpublic function checkWebAudioAPISupport():Bool {\n\t\tif (Reflect.field(Browser.window, \"AudioContext\") != null) {\n\t\t\tAudioContextClass = Reflect.field(Browser.window, \"AudioContext\");\n\t\t\treturn true;\n\t\t}\n\t\telse if (Reflect.field(Browser.window, \"webkitAudioContext\") != null) {\n\t\t\tAudioContextClass = Reflect.field(Browser.window, \"webkitAudioContext\");\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t* Function to unlock audio on `touchend` event.\n\t*\n\t* Used by {{#crossLink \"Waud/enableTouchUnlock:method\"}}Waud.enableTouchUnlock{{/crossLink}} method.\n\t*\n\t* @method unlockAudio\n\t*/\n\tpublic function unlockAudio() {\n\t\tif (audioContext == null) return;\n\t\tvar bfr = audioContext.createBuffer(1, 1, Waud.preferredSampleRate);\n\t\tvar src:AudioBufferSourceNode = audioContext.createBufferSource();\n\t\tsrc.buffer = bfr;\n\t\tsrc.connect(audioContext.destination);\n\t\tsrc.start(0);\n\t\tif (src.onended != null) src.onended = _unlockCallback;\n\t\telse haxe.Timer.delay(_unlockCallback, 1);\n\t}\n\n\tinline function _unlockCallback() {\n\t\tif (Waud.__touchUnlockCallback != null) Waud.__touchUnlockCallback();\n\t\tWaud.dom.ontouchend = null;\n\t}\n\n\t/**\n\t* Function to create audio context.\n\t*\n\t* Used by {{#crossLink \"Waud/init:method\"}}Waud.init{{/crossLink}} method.\n\t*\n\t* @method createAudioContext\n\t*/\n\tpublic function createAudioContext() {\n\t\tif (audioContext == null) {\n\t\t\ttry {\n\t\t\t\tif (AudioContextClass != null) audioContext = cast Type.createInstance(AudioContextClass, []);\n\t\t\t}\n\t\t\tcatch(e:Dynamic) {\n\t\t\t\taudioContext = null;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t* Function to close audio context and reset all variables.\n\t*\n\t* Used by {{#crossLink \"Waud/destroy:method\"}}Waud.destroy{{/crossLink}} method.\n\t*\n\t* @method destroy\n\t*/\n\tpublic function destroy() {\n\t\tif (audioContext != null && untyped __js__(\"this.audioContext\").close != null && untyped __js__(\"this.audioContext\").close != \"\") {\n\t\t\tuntyped __js__(\"this.audioContext\").close();\n\t\t}\n\t\taudioContext = null;\n\t\tbufferList = null;\n\t\tplayingSounds = null;\n\t\ttypes = null;\n\t}\n\n\t/**\n\t* This function suspends the progression of time in the audio context, temporarily halting audio hardware access and reducing CPU/battery usage in the process.\n\t* This is useful if you want an application to power down the audio hardware when it will not be using an audio context for a while.\n\t*\n\t* @method suspendContext\n\t* @example\n\t*     Waud.audioManager.suspendContext();\n\t*/\n\tpublic function suspendContext() {\n\t\tif (audioContext != null) {\n\t\t\tif (untyped __js__(\"this.audioContext\").suspend != null) untyped __js__(\"this.audioContext\").suspend();\n\t\t}\n\t}\n\n\t/**\n\t* This function resumes the progression of time in an audio context that has previously been suspended.\n\t*\n\t* @method resumeContext\n\t* @example\n\t*     Waud.audioManager.resumeContext();\n\t*/\n\tpublic function resumeContext() {\n\t\tif (audioContext != null) {\n\t\t\tif (untyped __js__(\"this.audioContext\").resume != null) untyped __js__(\"this.audioContext\").resume();\n\t\t}\n\t}\n}","@:keep class BaseSound {\n\n\tpublic var isSpriteSound:Bool;\n\tpublic var url:String;\n\n\tvar _options:WaudSoundOptions;\n\tvar _isLoaded:Bool;\n\tvar _isPlaying:Bool;\n\tvar _muted:Bool;\n\n\tpublic function new(sndUrl:String, ?options:WaudSoundOptions = null) {\n\t\tif (sndUrl == null || sndUrl == \"\") {\n\t\t\ttrace(\"invalid sound url\");\n\t\t\treturn;\n\t\t}\n\t\tif (Waud.audioManager == null) {\n\t\t\ttrace(\"initialise Waud using Waud.init() before loading sounds\");\n\t\t\treturn;\n\t\t}\n\t\tisSpriteSound = false;\n\t\turl = sndUrl;\n\t\t_isLoaded = false;\n\t\t_isPlaying = false;\n\t\t_muted = false;\n\t\tif (options == null) options = {};\n\n\t\toptions.autoplay = (options.autoplay != null) ? options.autoplay : Waud.defaults.autoplay;\n\t\toptions.webaudio = (options.webaudio != null) ? options.webaudio : Waud.defaults.webaudio;\n\t\toptions.preload = (options.preload != null) ? options.preload : Waud.defaults.preload;\n\t\toptions.loop = (options.loop != null) ? options.loop : Waud.defaults.loop;\n\t\toptions.volume = (options.volume != null && options.volume >= 0 && options.volume <= 1) ? options.volume : Waud.defaults.volume;\n\t\toptions.onload = (options.onload != null) ? options.onload : Waud.defaults.onload;\n\t\toptions.onend = (options.onend != null) ? options.onend : Waud.defaults.onend;\n\t\toptions.onerror = (options.onerror != null) ? options.onerror : Waud.defaults.onerror;\n\n\t\t_options = options;\n\t}\n}","import pixi.interaction.EventTarget;\nimport pixi.core.graphics.Graphics;\nimport pixi.core.math.shapes.Rectangle;\nimport pixi.core.text.Text;\nimport pixi.core.display.Container;\nimport msignal.Signal.Signal1;\n\nclass Button extends Container {\n\n\tpublic static inline var OVER_COLOUR:Int = 0xDF7401;\n\tpublic static inline var OUT_COLOUR:Int = 0x2E64FE;\n\tpublic static inline var TEXT_COLOUR:String = \"#FFFFFF\";\n\tpublic static inline var FONT_SIZE:Int = 12;\n\n\tvar _data:Dynamic;\n\tvar _label:Text;\n\tvar _rect:Rectangle;\n\tvar _background:Graphics;\n\n\tvar _enabled:Bool;\n\n\tpublic var action:Signal1<Dynamic>;\n\n\tpublic function new(label:String, width:Float, height:Float, ?data:Dynamic, ?fontSize:Int) {\n\t\tsuper();\n\t\taction = new Signal1(Dynamic);\n\t\t_data = data;\n\t\t_setupBackground(width, height);\n\t\t_setupLabel(width, height, fontSize);\n\t\tsetText(label);\n\t}\n\n\tfunction _setupBackground(width:Float, height:Float) {\n\t\t_rect = new Rectangle(0, 0, width, height);\n\t\t_background = new Graphics();\n\t\t_background.interactive = true;\n\t\t_redraw(OUT_COLOUR);\n\t\taddChild(_background);\n\n\t\t_background.interactive = true;\n\t\t_background.on(\"mouseover\", _onMouseOver);\n\t\t_background.on(\"mouseout\", _onMouseOut);\n\t\t_background.on(\"mousedown\", _onMouseDown);\n\t\t_background.on(\"mouseup\", _onMouseUp);\n\t\t_background.on(\"mouseupoutside\", _onMouseUpOutside);\n\t\t_background.on(\"touchstart\", _onTouchStart);\n\t\t_background.on(\"touchend\", _onTouchEnd);\n\t\t_background.on(\"touchendoutside\", _onTouchEndOutside);\n\t}\n\n\tfunction _setupLabel(width:Float, height:Float, fontSize:Int) {\n\t\tvar size:Int = (fontSize != null) ? fontSize : FONT_SIZE;\n\t\tvar style:TextStyle = {};\n\t\tstyle.font = (size) + \"px Arial\";\n\t\tstyle.fill = TEXT_COLOUR;\n\t\t_label = new Text(\"\", style);\n\t\t_label.anchor.set(0.5);\n\t\t_label.x = width / 2;\n\t\t_label.y = height / 2;\n\t\taddChild(_label);\n\t}\n\n\tfunction _redraw(colour:Int) {\n\t\tvar border:Float = 1;\n\t\t_background.clear();\n\t\t_background.beginFill(0x003366);\n\t\t_background.drawRect(_rect.x, _rect.y, _rect.width, _rect.height);\n\t\t_background.endFill();\n\t\t_background.beginFill(colour);\n\t\t_background.drawRect(_rect.x + border / 2, _rect.y + border / 2, _rect.width - border, _rect.height - border);\n\t\t_background.endFill();\n\t}\n\n\tpublic inline function setText(label:String) {\n\t\t_label.text = label;\n\t}\n\n\tfunction _onMouseDown(target:EventTarget) {\n\t\tif (_enabled) _redraw(OVER_COLOUR);\n\t}\n\n\tfunction _onMouseUp(target:EventTarget) {\n\t\tif (_enabled) {\n\t\t\taction.dispatch(_data);\n\t\t\t_redraw(OUT_COLOUR);\n\t\t}\n\t}\n\n\tfunction _onMouseUpOutside(target:EventTarget) {\n\t\tif (_enabled) _redraw(OUT_COLOUR);\n\t}\n\n\tfunction _onMouseOver(target:EventTarget) {\n\t\tif (_enabled) _redraw(OVER_COLOUR);\n\t}\n\n\tfunction _onMouseOut(target:EventTarget) {\n\t\tif (_enabled) _redraw(OUT_COLOUR);\n\t}\n\n\tfunction _onTouchEndOutside(target:EventTarget) {\n\t\tif (_enabled) _redraw(OUT_COLOUR);\n\t}\n\n\tfunction _onTouchEnd(target:EventTarget) {\n\t\tif (_enabled) {\n\t\t\t_redraw(OUT_COLOUR);\n\t\t\taction.dispatch(_data);\n\t\t}\n\t}\n\n\tfunction _onTouchStart(target:EventTarget) {\n\t\tif (_enabled) _redraw(OVER_COLOUR);\n\t}\n\n\tpublic inline function enable() {\n\t\t_enabled = true;\n\t}\n\n\tpublic function disable() {\n\t\t_redraw(OUT_COLOUR);\n\t\t_enabled = false;\n\t}\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:coreApi class EReg {\n\n\tvar r : HaxeRegExp;\n\n\tpublic function new( r : String, opt : String ) : Void {\n\t\topt = opt.split(\"u\").join(\"\"); // 'u' (utf8) depends on page encoding\n\t\tthis.r = new HaxeRegExp(r, opt);\n\t}\n\n\tpublic function match( s : String ) : Bool {\n\t\tif( r.global ) r.lastIndex = 0;\n\t\tr.m = r.exec(s);\n\t\tr.s = s;\n\t\treturn (r.m != null);\n\t}\n\n\tpublic function matched( n : Int ) : String {\n\t\treturn if( r.m != null && n >= 0 && n < r.m.length ) r.m[n] else throw \"EReg::matched\";\n\t}\n\n\tpublic function matchedLeft() : String {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\treturn r.s.substr(0,r.m.index);\n\t}\n\n\tpublic function matchedRight() : String {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\tvar sz = r.m.index+r.m[0].length;\n\t\treturn r.s.substr(sz,r.s.length-sz);\n\t}\n\n\tpublic function matchedPos() : { pos : Int, len : Int } {\n\t\tif( r.m == null ) throw \"No string matched\";\n\t\treturn { pos : r.m.index, len : r.m[0].length };\n\t}\n\n\tpublic function matchSub( s : String, pos : Int, len : Int = -1):Bool {\n\t\treturn if (r.global) {\n\t\t\tr.lastIndex = pos;\n\t\t\tr.m = r.exec(len < 0 ? s : s.substr(0, pos + len));\n\t\t\tvar b = r.m != null;\n\t\t\tif (b) {\n\t\t\t\tr.s = s;\n\t\t\t}\n\t\t\tb;\n\t\t} else {\n\t\t\t// TODO: check some ^/$ related corner cases\n\t\t\tvar b = match( len < 0 ? s.substr(pos) : s.substr(pos,len) );\n\t\t\tif (b) {\n\t\t\t\tr.s = s;\n\t\t\t\tr.m.index += pos;\n\t\t\t}\n\t\t\tb;\n\t\t}\n\t}\n\n\tpublic function split( s : String ) : Array<String> {\n\t\t// we can't use directly s.split because it's ignoring the 'g' flag\n\t\tvar d = \"#__delim__#\";\n\t\treturn untyped s.replace(r,d).split(d);\n\t}\n\n\tpublic function replace( s : String, by : String ) : String {\n\t\treturn untyped s.replace(r,by);\n\t}\n\n\tpublic function map( s : String, f : EReg -> String ) : String {\n\t\tvar offset = 0;\n\t\tvar buf = new StringBuf();\n\t\tdo {\n\t\t\tif (offset >= s.length)\n\t\t\t\tbreak;\n\t\t\telse if (!matchSub(s, offset)) {\n\t\t\t\tbuf.add(s.substr(offset));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvar p = matchedPos();\n\t\t\tbuf.add(s.substr(offset, p.pos - offset));\n\t\t\tbuf.add(f(this));\n\t\t\tif (p.len == 0) {\n\t\t\t\tbuf.add(s.substr(p.pos, 1));\n\t\t\t\toffset = p.pos + 1;\n\t\t\t}\n\t\t\telse\n\t\t\t\toffset = p.pos + p.len;\n\t\t} while (r.global);\n\t\tif (!r.global && offset > 0 && offset < s.length)\n\t\t\tbuf.add(s.substr(offset));\n\t\treturn buf.toString();\n\t}\n}\n\n@:native(\"RegExp\")\nprivate extern class HaxeRegExp extends js.RegExp {\n\tvar m:js.RegExp.RegExpMatch;\n\tvar s:String;\n}\n","import haxe.Timer;\nimport js.html.SourceElement;\nimport js.html.AudioElement;\n\n@:keep class HTML5Sound extends BaseSound implements IWaudSound {\n\n\tvar _snd:AudioElement;\n\tvar _src:SourceElement;\n\tvar _tmr:Timer;\n\n\tpublic function new(url:String, ?options:WaudSoundOptions = null) {\n\t\t#if debug trace(\"using html5 audio - \" + url); #end\n\t\tsuper(url, options);\n\t\t_snd = Waud.dom.createAudioElement();\n\t\t_addSource(url);\n\t\tif (_options.preload) load();\n\t}\n\n\tpublic function load(?callback:IWaudSound -> Void):IWaudSound {\n\t\tif (!_isLoaded) {\n\t\t\t_snd.autoplay = _options.autoplay;\n\t\t\t_snd.loop = _options.loop;\n\t\t\t_snd.volume = _options.volume;\n\n\t\t\tif (callback != null) _options.onload = callback;\n\n\t\t\tif (_options.preload) _snd.preload = \"auto\";\n\t\t\telse _snd.preload = \"metadata\"; //none\n\n\t\t\tif (_options.onload != null) {\n\t\t\t\t_isLoaded = true;\n\t\t\t\t_snd.onloadeddata = function() {\n\t\t\t\t\t_options.onload(this);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_snd.onplaying = function() {\n\t\t\t\t_isPlaying = true;\n\t\t\t}\n\n\t\t\t_snd.onended = function() {\n\t\t\t\t_isPlaying = false;\n\t\t\t\tif (_options.onend != null) _options.onend(this);\n\t\t\t}\n\n\t\t\tif (_options.onerror != null) {\n\t\t\t\t_snd.onerror = function() {\n\t\t\t\t\t_options.onerror(this);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t_snd.load();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tfunction _addSource(url:String):SourceElement {\n\t\t_src = Waud.dom.createSourceElement();\n\t\t_src.src = url;\n\n\t\tif (Waud.audioManager.types.get(_getExt(url)) != null) _src.type = Waud.audioManager.types.get(_getExt(url));\n\t\t_snd.appendChild(_src);\n\n\t\treturn _src;\n\t}\n\n\tfunction _getExt(filename:String):String {\n\t\treturn filename.split(\".\").pop();\n\t}\n\n\tpublic function setVolume(val:Float) {\n\t\tif (!_isLoaded) return;\n\t\tif (val >= 0 && val <= 1) {\n\t\t\t_snd.volume = val;\n\t\t\t_options.volume = val;\n\t\t}\n\t}\n\n\tpublic function getVolume():Float {\n\t\treturn _options.volume;\n\t}\n\n\tpublic function mute(val:Bool) {\n\t\tif (!_isLoaded) return;\n\t\t_snd.muted = val;\n\t\tif (WaudUtils.isiOS()) {\n\t\t\tif (val && isPlaying()) {\n\t\t\t\t_muted = true;\n\t\t\t\t_snd.pause();\n\t\t\t}\n\t\t\telse if (_muted) {\n\t\t\t\t_muted = false;\n\t\t\t\t_snd.play();\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic function play(?spriteName:String, ?soundProps:AudioSpriteSoundProperties):IWaudSound {\n\t\tif (!_isLoaded) {\n\t\t\ttrace(\"sound not loaded\");\n\t\t\treturn this;\n\t\t}\n\t\tif (_muted) return this;\n\t\tif (isSpriteSound && soundProps != null) {\n\t\t\t_snd.currentTime = soundProps.start;\n\t\t\tif (_tmr != null) _tmr.stop();\n\t\t\t_tmr = Timer.delay(function() {\n\t\t\t\tif (soundProps.loop != null && soundProps.loop) {\n\t\t\t\t\tplay(spriteName, soundProps);\n\t\t\t\t}\n\t\t\t\telse stop();\n\t\t\t}, Math.ceil(soundProps.duration * 1000));\n\t\t}\n\t\t_snd.play();\n\t\treturn this;\n\t}\n\n\tpublic function isPlaying():Bool {\n\t\treturn _isPlaying;\n\t}\n\n\tpublic function loop(val:Bool) {\n\t\tif (!_isLoaded) return;\n\t\t_snd.loop = val;\n\t}\n\n\tpublic function stop() {\n\t\tif (!_isLoaded) return;\n\t\t_snd.pause();\n\t\t_snd.currentTime = 0;\n\t}\n\n\tpublic function onEnd(callback:IWaudSound -> Void):IWaudSound {\n\t\t_options.onend = callback;\n\t\treturn this;\n\t}\n\n\tpublic function onLoad(callback:IWaudSound -> Void):IWaudSound {\n\t\t_options.onload = callback;\n\t\treturn this;\n\t}\n\n\tpublic function destroy() {\n\t\tif (_snd != null) {\n\t\t\t_snd.pause();\n\t\t\t_snd.removeChild(_src);\n\t\t\t_src = null;\n\t\t\t_snd = null;\n\t\t}\n\t}\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:noDoc\nclass HxOverrides {\n\n\tstatic function dateStr( date :Date ) : String {\n\t\tvar m = date.getMonth() + 1;\n\t\tvar d = date.getDate();\n\t\tvar h = date.getHours();\n\t\tvar mi = date.getMinutes();\n\t\tvar s = date.getSeconds();\n\t\treturn date.getFullYear()\n\t\t\t+\"-\"+(if( m < 10 ) \"0\"+m else \"\"+m)\n\t\t\t+\"-\"+(if( d < 10 ) \"0\"+d else \"\"+d)\n\t\t\t+\" \"+(if( h < 10 ) \"0\"+h else \"\"+h)\n\t\t\t+\":\"+(if( mi < 10 ) \"0\"+mi else \"\"+mi)\n\t\t\t+\":\"+(if( s < 10 ) \"0\"+s else \"\"+s);\n\t}\n\n\tstatic function strDate( s : String ) : Date {\n\t\tswitch( s.length ) {\n\t\tcase 8: // hh:mm:ss\n\t\t\tvar k = s.split(\":\");\n\t\t\tvar d : Date = untyped __new__(Date);\n\t\t\tuntyped d[\"setTime\"](0);\n\t\t\tuntyped d[\"setUTCHours\"](k[0]);\n\t\t\tuntyped d[\"setUTCMinutes\"](k[1]);\n\t\t\tuntyped d[\"setUTCSeconds\"](k[2]);\n\t\t\treturn d;\n\t\tcase 10: // YYYY-MM-DD\n\t\t\tvar k = s.split(\"-\");\n\t\t\treturn new Date(cast k[0],cast untyped k[1] - 1,cast k[2],0,0,0);\n\t\tcase 19: // YYYY-MM-DD hh:mm:ss\n\t\t\tvar k = s.split(\" \");\n\t\t\tvar y = k[0].split(\"-\");\n\t\t\tvar t = k[1].split(\":\");\n\t\t\treturn new Date(cast y[0],cast untyped y[1] - 1,cast y[2],cast t[0],cast t[1],cast t[2]);\n\t\tdefault:\n\t\t\tthrow \"Invalid date format : \" + s;\n\t\t}\n\t}\n\n\tstatic function cca( s : String, index : Int ) : Null<Int> {\n\t\tvar x = (cast s).charCodeAt(index);\n\t\tif( x != x ) // fast isNaN\n\t\t\treturn untyped undefined; // isNaN will still return true\n\t\treturn x;\n\t}\n\n\tstatic function substr( s : String, pos : Int, ?len : Int ) : String {\n\t\tif( pos != null && pos != 0 && len != null && len < 0 ) return \"\";\n\t\tif( len == null ) len = s.length;\n\t\tif( pos < 0 ){\n\t\t\tpos = s.length + pos;\n\t\t\tif( pos < 0 ) pos = 0;\n\t\t}else if( len < 0 ){\n\t\t\tlen = s.length + len - pos;\n\t\t}\n\n\t\treturn (untyped s).substr(pos, len);\n\t}\n\n\tstatic function indexOf<T>( a : Array<T>, obj : T, i : Int) {\n\t\tvar len = a.length;\n\t\tif (i < 0) {\n\t\t\ti += len;\n\t\t\tif (i < 0) i = 0;\n\t\t}\n\t\twhile (i < len)\n\t\t{\n\t\t\tif (untyped __js__(\"a[i] === obj\"))\n\t\t\t\treturn i;\n\t\t\ti++;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tstatic function lastIndexOf<T>( a : Array<T>, obj : T, i : Int) {\n\t\tvar len = a.length;\n\t\tif (i >= len)\n\t\t\ti = len - 1;\n\t\telse if (i < 0)\n\t\t\ti += len;\n\t\twhile (i >= 0)\n\t\t{\n\t\t\tif (untyped __js__(\"a[i] === obj\"))\n\t\t\t\treturn i;\n\t\t\ti--;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tstatic function remove<T>( a : Array<T>, obj : T ) {\n\t\tvar i = a.indexOf(obj);\n\t\tif( i == -1 ) return false;\n\t\ta.splice(i,1);\n\t\treturn true;\n\t}\n\n\tstatic function iter<T>( a : Array<T> ) : Iterator<T> untyped {\n\t\treturn {\n\t\t\tcur : 0,\n\t\t\tarr : a,\n\t\t\thasNext : function() {\n\t\t\t\treturn __this__.cur < __this__.arr.length;\n\t\t\t},\n\t\t\tnext : function() {\n\t\t\t\treturn __this__.arr[__this__.cur++];\n\t\t\t}\n\t\t};\n\t}\n\n\tstatic function __init__() untyped {\n#if !js_es5\n\t\t__feature__('HxOverrides.indexOf', if( Array.prototype.indexOf ) __js__(\"HxOverrides\").indexOf = function(a,o,i) return Array.prototype.indexOf.call(a, o, i));\n\t\t__feature__('HxOverrides.lastIndexOf', if( Array.prototype.lastIndexOf ) __js__(\"HxOverrides\").lastIndexOf = function(a,o,i) return Array.prototype.lastIndexOf.call(a, o, i));\n#end\n\t}\n\n}\n","package pixi.plugins.app;\n\nimport pixi.core.renderers.webgl.WebGLRenderer;\nimport pixi.core.renderers.canvas.CanvasRenderer;\nimport pixi.core.renderers.Detector;\nimport pixi.core.display.Container;\nimport js.html.Event;\nimport js.html.Element;\nimport js.html.CanvasElement;\nimport js.Browser;\n\n/**\n * Pixi Boilerplate Helper class that can be used by any application\n * @author Adi Reddy Mora\n * http://adireddy.github.io\n * @license MIT\n * @copyright 2015\n */\nclass Application {\n\n\t/**\n     * Sets the pixel ratio of the application.\n     * default - 1\n     */\n\tpublic var pixelRatio:Float;\n\n\t/**\n\t * Default frame rate is 60 FPS and this can be set to true to get 30 FPS.\n\t * default - false\n\t */\n\tpublic var skipFrame(default, set):Bool;\n\n\t/**\n\t * Default frame rate is 60 FPS and this can be set to anything between 1 - 60.\n\t * default - 60\n\t */\n\tpublic var fps(default, set):Int;\n\n\t/**\n\t * Width of the application.\n\t * default - Browser.window.innerWidth\n\t */\n\tpublic var width:Float;\n\n\t/**\n\t * Height of the application.\n\t * default - Browser.window.innerHeight\n\t */\n\tpublic var height:Float;\n\n\t/**\n\t * Renderer transparency property.\n\t * default - false\n\t */\n\tpublic var transparent:Bool;\n\n\t/**\n\t * Graphics antialias property.\n\t * default - false\n\t */\n\tpublic var antialias:Bool;\n\n\t/**\n\t * Force FXAA shader antialias instead of native (faster).\n\t * default - false\n\t */\n\tpublic var forceFXAA:Bool;\n\n\t/**\n\t * Force round pixels.\n\t * default - false\n\t */\n\tpublic var roundPixels:Bool;\n\n\t/**\n\t * This sets if the CanvasRenderer will clear the canvas or not before the new render pass.\n     * If the scene is NOT transparent Pixi will use a canvas sized fillRect operation every frame to set the canvas background color.\n     * If the scene is transparent Pixi will use clearRect to clear the canvas every frame.\n     * Disable this by setting this to false. For example if your game has a canvas filling background image you often don't need this set.\n\t * default - true\n\t */\n\tpublic var clearBeforeRender:Bool;\n\n\t/**\n\t * enables drawing buffer preservation, enable this if you need to call toDataUrl on the webgl context\n\t * default - false\n\t */\n\tpublic var preserveDrawingBuffer:Bool;\n\n\t/**\n\t * Whether you want to resize the canvas and renderer on browser resize.\n\t * Should be set to false when custom width and height are used for the application.\n\t * default - true\n\t */\n\tpublic var autoResize:Bool;\n\n\t/**\n\t * Sets the background color of the stage.\n\t * default - 0xFFFFFF\n\t */\n\tpublic var backgroundColor:Int;\n\n\t/**\n\t * Update listener \tfunction\n\t */\n\tpublic var onUpdate:Float -> Void;\n\n\t/**\n\t * Window resize listener \tfunction\n\t */\n\tpublic var onResize:Void -> Void;\n\n\t/**\n\t * Canvas Element\n\t * Read-only\n\t */\n\tpublic var canvas(default, null):CanvasElement;\n\n\t/**\n\t * Renderer\n\t * Read-only\n\t */\n\tpublic var renderer(default, null):Dynamic;\n\n\t/**\n\t * Global Container.\n\t * Read-only\n\t */\n\tpublic var stage(default, null):Container;\n\n\tpublic static inline var AUTO:String = \"auto\";\n\tpublic static inline var RECOMMENDED:String = \"recommended\";\n\tpublic static inline var CANVAS:String = \"canvas\";\n\tpublic static inline var WEBGL:String = \"webgl\";\n\n\tvar _frameCount:Int;\n\n\tpublic function new() {\n\t\t_setDefaultValues();\n\t}\n\n\tfunction set_fps(val:Int):Int {\n\t\t_frameCount = 0;\n\t\treturn fps = (val >= 1 && val < 60) ? Std.int(val) : 60;\n\t}\n\n\tfunction set_skipFrame(val:Bool):Bool {\n\t\tif (val) {\n\t\t\ttrace(\"pixi.plugins.app.Application > Deprecated: skipFrame - use fps property and set it to 30 instead\");\n\t\t\tfps = 30;\n\t\t}\n\t\treturn skipFrame = val;\n\t}\n\n\tinline function _setDefaultValues() {\n\t\tpixelRatio = 1;\n\t\tskipFrame = false;\n\t\tautoResize = true;\n\t\ttransparent = false;\n\t\tantialias = false;\n\t\tforceFXAA = false;\n\t\troundPixels = false;\n\t\tclearBeforeRender = true;\n\t\tpreserveDrawingBuffer = false;\n\t\tbackgroundColor = 0xFFFFFF;\n\t\twidth = Browser.window.innerWidth;\n\t\theight = Browser.window.innerHeight;\n\t\tfps = 60;\n\t}\n\n\t/**\n\t * Starts pixi application setup using the properties set or default values\n\t * @param [rendererType] - Renderer type to use AUTO (default) | CANVAS | WEBGL\n\t * @param [stats] - Enable/disable stats for the application.\n\t * Note that stats.js is not part of pixi so don't forget to include it you html page\n\t * Can be found in libs folder. \"libs/stats.min.js\" <script type=\"text/javascript\" src=\"libs/stats.min.js\"></script>\n\t * @param [parentDom] - By default canvas will be appended to body or it can be appended to custom element if passed\n\t */\n\n\tpublic function start(?rendererType:String = \"auto\", ?parentDom:Element) {\n\t\tcanvas = Browser.document.createCanvasElement();\n\t\tcanvas.style.width = width + \"px\";\n\t\tcanvas.style.height = height + \"px\";\n\t\tcanvas.style.position = \"absolute\";\n\t\tif (parentDom == null) Browser.document.body.appendChild(canvas);\n\t\telse parentDom.appendChild(canvas);\n\n\t\tstage = new Container();\n\n\t\tvar renderingOptions:RenderingOptions = {};\n\t\trenderingOptions.view = canvas;\n\t\trenderingOptions.backgroundColor = backgroundColor;\n\t\trenderingOptions.resolution = pixelRatio;\n\t\trenderingOptions.antialias = antialias;\n\t\trenderingOptions.forceFXAA = forceFXAA;\n\t\trenderingOptions.autoResize = autoResize;\n\t\trenderingOptions.transparent = transparent;\n\t\trenderingOptions.clearBeforeRender = clearBeforeRender;\n\t\trenderingOptions.preserveDrawingBuffer = preserveDrawingBuffer;\n\n\t\tif (rendererType == AUTO) renderer = Detector.autoDetectRenderer(width, height, renderingOptions);\n\t\telse if (rendererType == CANVAS) renderer = new CanvasRenderer(width, height, renderingOptions);\n\t\telse renderer = new WebGLRenderer(width, height, renderingOptions);\n\n\t\tif (roundPixels) renderer.roundPixels = true;\n\n\t\tBrowser.document.body.appendChild(renderer.view);\n\t\tif (autoResize) Browser.window.onresize = _onWindowResize;\n\t\tBrowser.window.requestAnimationFrame(_onRequestAnimationFrame);\n\n\t\t#if stats addStats(); #end\n\t}\n\n\tpublic function pauseRendering() {\n\t\tBrowser.window.onresize = null;\n\t\tBrowser.window.requestAnimationFrame(function(elapsedTime) {});\n\t}\n\n\tpublic function resumeRendering() {\n\t\tif (autoResize) Browser.window.onresize = _onWindowResize;\n\t\tBrowser.window.requestAnimationFrame(_onRequestAnimationFrame);\n\t}\n\n\t@:noCompletion function _onWindowResize(event:Event) {\n\t\twidth = Browser.window.innerWidth;\n\t\theight = Browser.window.innerHeight;\n\t\trenderer.resize(width, height);\n\t\tcanvas.style.width = width + \"px\";\n\t\tcanvas.style.height = height + \"px\";\n\n\t\tif (onResize != null) onResize();\n\t}\n\n\t@:noCompletion function _onRequestAnimationFrame(elapsedTime:Float) {\n\t\t_frameCount++;\n\t\tif (_frameCount == Std.int(60 / fps)) {\n\t\t\t_frameCount = 0;\n\t\t\tif (onUpdate != null) onUpdate(elapsedTime);\n\t\t\trenderer.render(stage);\n\t\t}\n\t\tBrowser.window.requestAnimationFrame(_onRequestAnimationFrame);\n\t}\n\n\tpublic function addStats() {\n\t\tif (untyped __js__(\"window\").Perf != null) {\n\t\t\tnew Perf().addInfo([\"UNKNOWN\", \"WEBGL\", \"CANVAS\"][renderer.type] + \" - \" + pixelRatio);\n\t\t}\n\t}\n}","import js.Browser;\nimport pixi.core.Pixi;\nimport pixi.core.text.Text;\nimport pixi.core.display.Container;\nimport pixi.plugins.app.Application;\n\nclass Main extends Application {\n\n\tvar _btnContainer:Container;\n\n\tvar _bgSnd:IWaudSound;\n\tvar _glassAAC:IWaudSound;\n\tvar _bellAAC:IWaudSound;\n\tvar _canAAC:IWaudSound;\n\tvar _glassMP3:IWaudSound;\n\tvar _bellMP3:IWaudSound;\n\tvar _canMP3:IWaudSound;\n\tvar _glassOGG:IWaudSound;\n\tvar _bellOGG:IWaudSound;\n\tvar _canOGG:IWaudSound;\n\n\tvar _audSprite:IWaudSound;\n\n\tvar _ua:Text;\n\n\tpublic function new() {\n\t\tsuper();\n\t\tPixi.RESOLUTION = pixelRatio = Browser.window.devicePixelRatio;\n\t\tautoResize = true;\n\t\tbackgroundColor = 0x5F04B4;\n\t\troundPixels = true;\n\t\tonResize = _resize;\n\t\tsuper.start();\n\n\t\t_btnContainer = new Container();\n\t\tstage.addChild(_btnContainer);\n\n\t\tvar label:Text = new Text(\"MP3: \", { font: \"26px Tahoma\", fill:\"#FFFFFF\" });\n\t\t_btnContainer.addChild(label);\n\t\t_addButton(\"Glass\", 120, 0, 60, 30, function() { _glassMP3.play(); });\n\t\t_addButton(\"Bell\", 180, 0, 60, 30, function() { _bellMP3.play(); });\n\t\t_addButton(\"Can\", 240, 0, 60, 30, function() { _canMP3.play(); });\n\n\t\tlabel = new Text(\"AAC: \", { font: \"26px Tahoma\", fill:\"#FFFFFF\" });\n\t\t_btnContainer.addChild(label);\n\t\tlabel.position.y = 50;\n\t\t_addButton(\"Glass\", 120, 50, 60, 30, function() { _glassAAC.play(); });\n\t\t_addButton(\"Bell\", 180, 50, 60, 30, function() { _bellAAC.play(); });\n\t\t_addButton(\"Can\", 240, 50, 60, 30, function() { _canAAC.play(); });\n\n\t\tlabel = new Text(\"OGG: \", { font: \"26px Tahoma\", fill:\"#FFFFFF\" });\n\t\t_btnContainer.addChild(label);\n\t\tlabel.position.y = 100;\n\t\t_addButton(\"Glass\", 120, 100, 60, 30, function() { _glassOGG.play(); });\n\t\t_addButton(\"Bell\", 180, 100, 60, 30, function() { _bellOGG.play(); });\n\t\t_addButton(\"Can\", 240, 100, 60, 30, function() { _canOGG.play(); });\n\n\t\tlabel = new Text(\"Controls: \", { font: \"26px Tahoma\", fill:\"#FFFFFF\" });\n\t\t_btnContainer.addChild(label);\n\t\tlabel.position.y = 150;\n\t\t_addButton(\"Mute\", 120, 150, 60, 30, _mute);\n\t\t_addButton(\"Unmute\", 180, 150, 60, 30, _unmute);\n\t\t_addButton(\"BG Vol 0\", 240, 150, 60, 30, function() { _bgSnd.setVolume(0); });\n\t\t_addButton(\"BG Vol 1\", 300, 150, 60, 30, function() { _bgSnd.setVolume(1); });\n\t\t_addButton(\"Stop\", 360, 150, 60, 30, _stop);\n\n\t\t// Audio Sprite\n\t\tlabel = new Text(\"Sprite: \", { font: \"26px Tahoma\", fill:\"#FFFFFF\" });\n\t\t_btnContainer.addChild(label);\n\t\tlabel.position.y = 200;\n\t\t_addButton(\"Glass\", 120, 200, 60, 30, function() { _audSprite.play(\"glass\").onEnd(function(s) { trace(\"ONEND\"); }); });\n\t\t_addButton(\"Bell\", 180, 200, 60, 30, function() { _audSprite.play(\"bell\"); });\n\t\t_addButton(\"Can\", 240, 200, 60, 30, function() { _audSprite.play(\"canopening\"); });\n\n\t\t_addButton(\"DESTROY\", 120, 250, 180, 30, function() { Waud.destroy(); });\n\n\t\t_ua = new Text(Browser.navigator.userAgent, { font: \"12px Tahoma\", fill:\"#FFFFFF\" });\n\t\tstage.addChild(_ua);\n\n\t\tWaud.init();\n\t\tWaud.autoMute();\n\t\tWaud.enableTouchUnlock(touchUnlock);\n\t\tWaud.defaults.onload = _onLoad;\n\t\t_bgSnd = new WaudSound(\"assets/loop.mp3\", { loop:true, autoplay: false, volume: 1, onload: _playBgSound });\n\n\t\t_glassMP3 = new WaudSound(\"assets/glass.mp3\", {preload: false, webaudio: false});\n\t\t_bellMP3 = new WaudSound(\"assets/bell.mp3\");\n\t\t_canMP3 = new WaudSound(\"assets/canopening.mp3\");\n\n\t\t_glassAAC = new WaudSound(\"assets/glass.aac\");\n\t\t_bellAAC = new WaudSound(\"assets/bell.aac\");\n\t\t_canAAC = new WaudSound(\"assets/canopening.aac\");\n\n\t\t_glassOGG = new WaudSound(\"assets/glass.ogg\");\n\t\t_bellOGG = new WaudSound(\"assets/bell.ogg\");\n\t\t_canOGG = new WaudSound(\"assets/canopening.ogg\");\n\n\t\t_ua.text += \"\\n\" + Waud.getFormatSupportString();\n\t\t_ua.text += \"\\nWeb Audio API: \" + Waud.isWebAudioSupported;\n\t\t_ua.text += \"\\nHTML5 Audio: \" + Waud.isHTML5AudioSupported;\n\n\t\t_audSprite = new WaudSound(\"assets/sprite.json\");\n\n\t\t_glassMP3.load(_onLoad);\n\n\t\t_resize();\n\t}\n\n\tfunction _onLoad(snd:IWaudSound) {\n\t\ttrace(snd.url);\n\t}\n\n\tfunction touchUnlock() {\n\t\tif (!_bgSnd.isPlaying()) _bgSnd.play();\n\t}\n\n\tfunction _playBgSound(snd:IWaudSound) {\n\t\tif (!snd.isPlaying()) snd.play();\n\t}\n\n\tfunction _mute() {\n\t\tWaud.mute(true);\n\t}\n\n\tfunction _unmute() {\n\t\tWaud.mute(false);\n\t}\n\n\tfunction _stop() {\n\t\tWaud.stop();\n\t}\n\n\tfunction _addButton(label:String, x:Float, y:Float, width:Float, height:Float, callback:Dynamic) {\n\t\tvar btn:Button = new Button(label, width, height);\n\t\tbtn.position.set(x, y);\n\t\tbtn.action.add(callback);\n\t\tbtn.enable();\n\t\t_btnContainer.addChild(btn);\n\t}\n\n\tfunction _resize() {\n\t\t_btnContainer.position.set((Browser.window.innerWidth - _btnContainer.width) / 2, (Browser.window.innerHeight - _btnContainer.height) / 2);\n\t}\n\n\tstatic function main() {\n\t\tnew Main();\n\t}\n}","import js.html.Performance;\nimport js.html.DivElement;\nimport js.Browser;\n\n@:expose class Perf {\n\n\tpublic static var MEASUREMENT_INTERVAL:Int = 1000;\n\n\tpublic static var FONT_FAMILY:String = \"Helvetica,Arial\";\n\n\tpublic static var FPS_BG_CLR:String = \"#00FF00\";\n\tpublic static var FPS_WARN_BG_CLR:String = \"#FF8000\";\n\tpublic static var FPS_PROB_BG_CLR:String = \"#FF0000\";\n\n\tpublic static var MS_BG_CLR:String = \"#FFFF00\";\n\tpublic static var MEM_BG_CLR:String = \"#086A87\";\n\tpublic static var INFO_BG_CLR:String = \"#00FFFF\";\n\tpublic static var FPS_TXT_CLR:String = \"#000000\";\n\tpublic static var MS_TXT_CLR:String = \"#000000\";\n\tpublic static var MEM_TXT_CLR:String = \"#FFFFFF\";\n\tpublic static var INFO_TXT_CLR:String = \"#000000\";\n\n\tpublic static var TOP_LEFT:String = \"TL\";\n\tpublic static var TOP_RIGHT:String = \"TR\";\n\tpublic static var BOTTOM_LEFT:String = \"BL\";\n\tpublic static var BOTTOM_RIGHT:String = \"BR\";\n\n\tpublic var fps:DivElement;\n\tpublic var ms:DivElement;\n\tpublic var memory:DivElement;\n\tpublic var info:DivElement;\n\n\tpublic var currentFps:Float;\n\tpublic var currentMs:Float;\n\tpublic var currentMem:String;\n\n\tvar _time:Float;\n\tvar _startTime:Float;\n\tvar _prevTime:Float;\n\tvar _ticks:Int;\n\tvar _fpsMin:Float;\n\tvar _fpsMax:Float;\n\tvar _memCheck:Bool;\n\tvar _pos:String;\n\tvar _offset:Float;\n\n\tvar _perfObj:Performance;\n\tvar _memoryObj:Memory;\n\n\tpublic function new(?pos = \"TR\", ?offset:Float = 0) {\n\t\t_perfObj = Browser.window.performance;\n\t\t_memoryObj = untyped __js__(\"window.performance\").memory;\n\t\t_memCheck = (_perfObj != null && _memoryObj != null && _memoryObj.totalJSHeapSize > 0);\n\n\t\tcurrentFps = 0;\n\t\tcurrentMs = 0;\n\t\tcurrentMem = \"0\";\n\n\t\t_pos = pos;\n\t\t_offset = offset;\n\t\t_time = 0;\n\t\t_ticks = 0;\n\t\t_fpsMin = Math.POSITIVE_INFINITY;\n\t\t_fpsMax = 0;\n\t\t_startTime = _now();\n\t\t_prevTime = -MEASUREMENT_INTERVAL;\n\n\t\t_createFpsDom();\n\t\t_createMsDom();\n\t\tif (_memCheck) _createMemoryDom();\n\t\tBrowser.window.requestAnimationFrame(cast _tick);\n\t}\n\n\tinline function _now():Float {\n\t\treturn (_perfObj != null && _perfObj.now != null) ? _perfObj.now() : Date.now().getTime();\n\t}\n\n\tfunction _tick() {\n\t\tvar time = _now();\n\t\t_ticks++;\n\n\t\tif (time > _prevTime + MEASUREMENT_INTERVAL) {\n\t\t\tcurrentMs = Math.round(time - _startTime);\n\t\t\tms.innerHTML = \"MS: \" + currentMs;\n\n\t\t\tcurrentFps = Math.round((_ticks * 1000) / (time - _prevTime));\n\t\t\t_fpsMin = Math.min(_fpsMin, currentFps);\n\t\t\t_fpsMax = Math.max(_fpsMax, currentFps);\n\n\t\t\tfps.innerHTML =  \"FPS: \" + currentFps + \" (\" + _fpsMin + \"-\" + _fpsMax + \")\";\n\n\t\t\tif (currentFps >= 30) fps.style.backgroundColor = FPS_BG_CLR;\n\t\t\telse if (currentFps >= 15) fps.style.backgroundColor = FPS_WARN_BG_CLR;\n\t\t\telse fps.style.backgroundColor = FPS_PROB_BG_CLR;\n\n\t\t\t_prevTime = time;\n\t\t\t_ticks = 0;\n\n\t\t\tif (_memCheck) {\n\t\t\t\tcurrentMem = _getFormattedSize(_memoryObj.usedJSHeapSize, 2);\n\t\t\t\tmemory.innerHTML = \"MEM: \" + currentMem;\n\t\t\t}\n\t\t}\n\t\t_startTime =  time;\n\n\t\tBrowser.window.requestAnimationFrame(cast _tick);\n\t}\n\n\tfunction _createDiv(id:String, ?top:Float = 0):DivElement {\n\t\tvar div:DivElement = Browser.document.createDivElement();\n\t\tdiv.id = id;\n\t\tdiv.className = id;\n\t\tdiv.style.position = \"absolute\";\n\n\t\tswitch (_pos) {\n\t\t\tcase \"TL\":\n\t\t\t\tdiv.style.left = _offset + \"px\";\n\t\t\t\tdiv.style.top = top + \"px\";\n\t\t\tcase \"TR\":\n\t\t\t\tdiv.style.right = _offset + \"px\";\n\t\t\t\tdiv.style.top = top + \"px\";\n\t\t\tcase \"BL\":\n\t\t\t\tdiv.style.left = _offset + \"px\";\n\t\t\t\tdiv.style.bottom = ((_memCheck) ? 48 : 32) - top + \"px\";\n\t\t\tcase \"BR\":\n\t\t\t\tdiv.style.right = _offset + \"px\";\n\t\t\t\tdiv.style.bottom = ((_memCheck) ? 48 : 32) - top + \"px\";\n\t\t}\n\n\t\tdiv.style.width = \"80px\";\n\t\tdiv.style.height = \"12px\";\n\t\tdiv.style.lineHeight = \"12px\";\n\t\tdiv.style.padding = \"2px\";\n\t\tdiv.style.fontFamily = FONT_FAMILY;\n\t\tdiv.style.fontSize = \"9px\";\n\t\tdiv.style.fontWeight = \"bold\";\n\t\tdiv.style.textAlign = \"center\";\n\t\tBrowser.document.body.appendChild(div);\n\t\treturn div;\n\t}\n\n\tfunction _createFpsDom() {\n\t\tfps = _createDiv(\"fps\");\n\t\tfps.style.backgroundColor = FPS_BG_CLR;\n\t\tfps.style.zIndex = \"995\";\n\t\tfps.style.color = FPS_TXT_CLR;\n\t\tfps.innerHTML = \"FPS: 0\";\n\t}\n\n\tfunction _createMsDom() {\n\t\tms = _createDiv(\"ms\", 16);\n\t\tms.style.backgroundColor = MS_BG_CLR;\n\t\tms.style.zIndex = \"996\";\n\t\tms.style.color = MS_TXT_CLR;\n\t\tms.innerHTML = \"MS: 0\";\n\t}\n\n\tfunction _createMemoryDom() {\n\t\tmemory = _createDiv(\"memory\", 32);\n\t\tmemory.style.backgroundColor = MEM_BG_CLR;\n\t\tmemory.style.color = MEM_TXT_CLR;\n\t\tmemory.style.zIndex = \"997\";\n\t\tmemory.innerHTML = \"MEM: 0\";\n\t}\n\n\tfunction _getFormattedSize(bytes:Float, ?frac:Int = 0):String {\n\t\tvar sizes = [\"Bytes\", \"KB\", \"MB\", \"GB\", \"TB\"];\n\t\tif (bytes == 0) return \"0\";\n\t\tvar precision = Math.pow(10, frac);\n\t\tvar i = Math.floor(Math.log(bytes) / Math.log(1024));\n\t\treturn Math.round(bytes * precision / Math.pow(1024, i)) / precision + \" \" + sizes[i];\n\t}\n\n\tpublic function addInfo(val:String) {\n\t\tinfo = _createDiv(\"info\", (_memCheck) ? 48 : 32);\n\t\tinfo.style.backgroundColor = INFO_BG_CLR;\n\t\tinfo.style.color = INFO_TXT_CLR;\n\t\tinfo.style.zIndex = \"998\";\n\t\tinfo.innerHTML = val;\n\t}\n\n\tpublic function clearInfo() {\n\t\tif (info != null) {\n\t\t\tBrowser.document.body.removeChild(info);\n\t\t\tinfo = null;\n\t\t}\n\t}\n}\n\ntypedef Memory = {\n\tvar usedJSHeapSize:Float;\n\tvar totalJSHeapSize:Float;\n\tvar jsHeapSizeLimit:Float;\n}","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\n@:coreApi class Reflect {\n\n\tpublic inline static function hasField( o : Dynamic, field : String ) : Bool {\n\t\treturn untyped __js__('Object').prototype.hasOwnProperty.call(o, field);\n\t}\n\n\tpublic static function field( o : Dynamic, field : String ) : Dynamic {\n\t\ttry return untyped o[field] catch( e : Dynamic ) return null;\n\t}\n\n\tpublic inline static function setField( o : Dynamic, field : String, value : Dynamic ) : Void untyped {\n\t\to[field] = value;\n\t}\n\n\tpublic static inline function getProperty( o : Dynamic, field : String ) : Dynamic untyped {\n\t\tvar tmp;\n\t\treturn if( o == null ) __define_feature__(\"Reflect.getProperty\",null) else if( o.__properties__ && (tmp=o.__properties__[\"get_\"+field]) ) o[tmp]() else o[field];\n\t}\n\n\tpublic static inline function setProperty( o : Dynamic, field : String, value : Dynamic ) : Void untyped {\n\t\tvar tmp;\n\t\tif( o.__properties__ && (tmp=o.__properties__[\"set_\"+field]) ) o[tmp](value) else o[field] = __define_feature__(\"Reflect.setProperty\",value);\n\t}\n\n\tpublic inline static function callMethod( o : Dynamic, func : haxe.Constraints.Function, args : Array<Dynamic> ) : Dynamic untyped {\n\t\treturn func.apply(o,args);\n\t}\n\n\tpublic static function fields( o : Dynamic ) : Array<String> {\n\t\tvar a = [];\n\t\tif (o != null) untyped {\n\t\t\tvar hasOwnProperty = __js__('Object').prototype.hasOwnProperty;\n\t\t\t__js__(\"for( var f in o ) {\");\n\t\t\tif( f != \"__id__\" && f != \"hx__closures__\" && hasOwnProperty.call(o, f) ) a.push(f);\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn a;\n\t}\n\n\tpublic static function isFunction( f : Dynamic ) : Bool untyped {\n\t\treturn __js__(\"typeof(f)\") == \"function\" && !(js.Boot.isClass(f) || js.Boot.isEnum(f));\n\t}\n\n\tpublic static function compare<T>( a : T, b : T ) : Int {\n\t\treturn ( a == b ) ? 0 : (((cast a) > (cast b)) ? 1 : -1);\n\t}\n\n\tpublic static function compareMethods( f1 : Dynamic, f2 : Dynamic ) : Bool {\n\t\tif( f1 == f2 )\n\t\t\treturn true;\n\t\tif( !isFunction(f1) || !isFunction(f2) )\n\t\t\treturn false;\n\t\treturn f1.scope == f2.scope && f1.method == f2.method && f1.method != null;\n\t}\n\n\tpublic static function isObject( v : Dynamic ) : Bool untyped {\n\t\tif( v == null )\n\t\t\treturn false;\n\t\tvar t = __js__(\"typeof(v)\");\n\t\treturn (t == \"string\" || (t == \"object\" && v.__enum__ == null)) || (t == \"function\" && (js.Boot.isClass(v) || js.Boot.isEnum(v)) != null);\n\t}\n\n\tpublic static function isEnumValue( v : Dynamic ) : Bool {\n\t\treturn v != null && v.__enum__ != null;\n\t}\n\n\tpublic static function deleteField( o : Dynamic, field : String ) : Bool untyped {\n\t\tif( !hasField(o,field) ) return false;\n\t\t__js__(\"delete\")(o[field]);\n\t\treturn true;\n\t}\n\n\tpublic static function copy<T>( o : T ) : T {\n\t\tvar o2 : Dynamic = {};\n\t\tfor( f in Reflect.fields(o) )\n\t\t\tReflect.setField(o2,f,Reflect.field(o,f));\n\t\treturn o2;\n\t}\n\n\t@:overload(function( f : Array<Dynamic> -> Void ) : Dynamic {})\n\tpublic static function makeVarArgs( f : Array<Dynamic> -> Dynamic ) : Dynamic {\n\t\treturn function() {\n\t\t\tvar a = untyped Array.prototype.slice.call(__js__(\"arguments\"));\n\t\t\treturn f(a);\n\t\t};\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\nimport js.Boot;\n\n@:keepInit\n@:coreApi class Std {\n\n\tpublic static inline function is( v : Dynamic, t : Dynamic ) : Bool {\n\t\treturn untyped js.Boot.__instanceof(v,t);\n\t}\n\n\tpublic static inline function instance<T:{},S:T>( value : T, c : Class<S> ) : S {\n\t\treturn untyped __instanceof__(value, c) ? cast value : null;\n\t}\n\n\tpublic static function string( s : Dynamic ) : String {\n\t\treturn untyped js.Boot.__string_rec(s,\"\");\n\t}\n\n\tpublic static inline function int( x : Float ) : Int {\n\t\treturn (cast x) | 0;\n\t}\n\n\tpublic static function parseInt( x : String ) : Null<Int> {\n\t\tvar v = untyped __js__(\"parseInt\")(x, 10);\n\t\t// parse again if hexadecimal\n\t\tif( v == 0 && (x.charCodeAt(1) == 'x'.code || x.charCodeAt(1) == 'X'.code) )\n\t\t\tv = untyped __js__(\"parseInt\")(x);\n\t\tif( untyped __js__(\"isNaN\")(v) )\n\t\t\treturn null;\n\t\treturn cast v;\n\t}\n\n\tpublic static inline function parseFloat( x : String ) : Float {\n\t\treturn untyped __js__(\"parseFloat\")(x);\n\t}\n\n\tpublic static function random( x : Int ) : Int {\n\t\treturn untyped x <= 0 ? 0 : Math.floor(Math.random()*x);\n\t}\n\n\tstatic function __init__() : Void untyped {\n\t\t__feature__(\"js.Boot.getClass\",String.prototype.__class__ = __feature__(\"Type.resolveClass\",$hxClasses[\"String\"] = String,String));\n\t\t__feature__(\"js.Boot.isClass\",String.__name__ = __feature__(\"Type.getClassName\",[\"String\"],true));\n\t\t__feature__(\"Type.resolveClass\",$hxClasses[\"Array\"] = Array);\n\t\t__feature__(\"js.Boot.isClass\",Array.__name__ = __feature__(\"Type.getClassName\",[\"Array\"],true));\n\t\t__feature__(\"Date.*\", {\n\t\t\t__feature__(\"js.Boot.getClass\",__js__('Date').prototype.__class__ = __feature__(\"Type.resolveClass\",$hxClasses[\"Date\"] = __js__('Date'),__js__('Date')));\n\t\t\t__feature__(\"js.Boot.isClass\",__js__('Date').__name__ = [\"Date\"]);\n\t\t});\n\t\t__feature__(\"Int.*\",{\n\t\t\tvar Int = __feature__(\"Type.resolveClass\", $hxClasses[\"Int\"] = { __name__ : [\"Int\"] }, { __name__ : [\"Int\"] });\n\t\t});\n\t\t__feature__(\"Dynamic.*\",{\n\t\t\tvar Dynamic = __feature__(\"Type.resolveClass\", $hxClasses[\"Dynamic\"] = { __name__ : [\"Dynamic\"] }, { __name__ : [\"Dynamic\"] });\n\t\t});\n\t\t__feature__(\"Float.*\",{\n\t\t\tvar Float = __feature__(\"Type.resolveClass\", $hxClasses[\"Float\"] = __js__(\"Number\"), __js__(\"Number\"));\n\t\t\tFloat.__name__ = [\"Float\"];\n\t\t});\n\t\t__feature__(\"Bool.*\",{\n\t\t\tvar Bool = __feature__(\"Type.resolveEnum\",$hxClasses[\"Bool\"] = __js__(\"Boolean\"), __js__(\"Boolean\"));\n\t\t\tBool.__ename__ = [\"Bool\"];\n\t\t});\n\t\t__feature__(\"Class.*\",{\n\t\t\tvar Class = __feature__(\"Type.resolveClass\", $hxClasses[\"Class\"] = { __name__ : [\"Class\"] }, { __name__ : [\"Class\"] });\n\t\t});\n\t\t__feature__(\"Enum.*\",{\n\t\t\tvar Enum = {};\n\t\t});\n\t\t__feature__(\"Void.*\",{\n\t\t\tvar Void = __feature__(\"Type.resolveEnum\", $hxClasses[\"Void\"] = { __ename__ : [\"Void\"] }, { __ename__ : [\"Void\"] });\n\t\t});\n\n#if !js_es5\n\t\t__feature__(\"Array.map\",\n\t\t\tif( Array.prototype.map == null )\n\t\t\t\tArray.prototype.map = function(f) {\n\t\t\t\t\tvar a = [];\n\t\t\t\t\tfor( i in 0...__this__.length )\n\t\t\t\t\t\ta[i] = f(__this__[i]);\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t);\n\t\t__feature__(\"Array.filter\",\n\t\t\tif( Array.prototype.filter == null )\n\t\t\t\tArray.prototype.filter = function(f) {\n\t\t\t\t\tvar a = [];\n\t\t\t\t\tfor( i in 0...__this__.length ) {\n\t\t\t\t\t\tvar e = __this__[i];\n\t\t\t\t\t\tif( f(e) ) a.push(e);\n\t\t\t\t\t}\n\t\t\t\t\treturn a;\n\t\t\t\t}\n\t\t);\n#end\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\nenum ValueType {\n\tTNull;\n\tTInt;\n\tTFloat;\n\tTBool;\n\tTObject;\n\tTFunction;\n\tTClass( c : Class<Dynamic> );\n\tTEnum( e : Enum<Dynamic> );\n\tTUnknown;\n}\n\n@:coreApi class Type {\n\n\tpublic static inline function getClass<T>( o : T ) : Class<T> {\n\t\treturn if (o == null) null else @:privateAccess js.Boot.getClass(o);\n\t}\n\n\tpublic static function getEnum( o : EnumValue ) : Enum<Dynamic> untyped {\n\t\tif( o == null )\n\t\t\treturn null;\n\t\treturn o.__enum__;\n\t}\n\n\tpublic static function getSuperClass( c : Class<Dynamic> ) : Class<Dynamic> untyped {\n\t\treturn c.__super__;\n\t}\n\n\n\tpublic static function getClassName( c : Class<Dynamic> ) : String {\n\t\tvar a : Array<String> = untyped c.__name__;\n\t\tif (a == null)\n\t\t\treturn null;\n\t\treturn a.join(\".\");\n\t}\n\n\tpublic static function getEnumName( e : Enum<Dynamic> ) : String {\n\t\tvar a : Array<String> = untyped e.__ename__;\n\t\treturn a.join(\".\");\n\t}\n\n\tpublic static function resolveClass( name : String ) : Class<Dynamic> untyped {\n\t\tvar cl : Class<Dynamic> = $hxClasses[name];\n\t\t// ensure that this is a class\n\t\tif( cl == null || !js.Boot.isClass(cl) )\n\t\t\treturn null;\n\t\treturn cl;\n\t}\n\n\tpublic static function resolveEnum( name : String ) : Enum<Dynamic> untyped {\n\t\tvar e : Dynamic = $hxClasses[name];\n\t\t// ensure that this is an enum\n\t\tif( e == null || !js.Boot.isEnum(e) )\n\t\t\treturn null;\n\t\treturn e;\n\t}\n\n\tpublic static function createInstance<T>( cl : Class<T>, args : Array<Dynamic> ) : T untyped {\n\t\tswitch( args.length ) {\n\t\tcase 0:\n\t\t\treturn __new__(cl);\n\t\tcase 1:\n\t\t\treturn __new__(cl,args[0]);\n\t\tcase 2:\n\t\t\treturn __new__(cl,args[0],args[1]);\n\t\tcase 3:\n\t\t\treturn __new__(cl,args[0],args[1],args[2]);\n\t\tcase 4:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3]);\n\t\tcase 5:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4]);\n\t\tcase 6:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5]);\n\t\tcase 7:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6]);\n\t\tcase 8:\n\t\t\treturn __new__(cl,args[0],args[1],args[2],args[3],args[4],args[5],args[6],args[7]);\n\t\tdefault:\n\t\t\tthrow \"Too many arguments\";\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic static function createEmptyInstance<T>( cl : Class<T> ) : T untyped {\n\t\t__js__(\"function empty() {}; empty.prototype = cl.prototype\");\n\t\treturn __js__(\"new empty()\");\n\t}\n\n\tpublic static function createEnum<T>( e : Enum<T>, constr : String, ?params : Array<Dynamic> ) : T {\n\t\tvar f:Dynamic = Reflect.field(e,constr);\n\t\tif( f == null ) throw \"No such constructor \"+constr;\n\t\tif( Reflect.isFunction(f) ) {\n\t\t\tif( params == null ) throw \"Constructor \"+constr+\" need parameters\";\n\t\t\treturn Reflect.callMethod(e,f,params);\n\t\t}\n\t\tif( params != null && params.length != 0 )\n\t\t\tthrow \"Constructor \"+constr+\" does not need parameters\";\n\t\treturn f;\n\t}\n\n\tpublic static function createEnumIndex<T>( e : Enum<T>, index : Int, ?params : Array<Dynamic> ) : T {\n\t\tvar c : String = (untyped e.__constructs__)[index];\n\t\tif( c == null ) throw index+\" is not a valid enum constructor index\";\n\t\treturn createEnum(e,c,params);\n\t}\n\n\tpublic static function getInstanceFields( c : Class<Dynamic> ) : Array<String> {\n\t\tvar a = [];\n\t\tuntyped __js__(\"for(var i in c.prototype) a.push(i)\");\n\t\ta.remove(\"__class__\");\n\t\ta.remove(\"__properties__\");\n\t\treturn a;\n\t}\n\n\tpublic static function getClassFields( c : Class<Dynamic> ) : Array<String> {\n\t\tvar a = Reflect.fields(c);\n\t\ta.remove(\"__name__\");\n\t\ta.remove(\"__interfaces__\");\n\t\ta.remove(\"__properties__\");\n\t\ta.remove(\"__super__\");\n\t\ta.remove(\"__meta__\");\n\t\ta.remove(\"prototype\");\n\t\treturn a;\n\t}\n\n\tpublic static function getEnumConstructs( e : Enum<Dynamic> ) : Array<String> {\n\t\tvar a : Array<String> = untyped e.__constructs__;\n\t\treturn a.copy();\n\t}\n\n\tpublic static function typeof( v : Dynamic ) : ValueType untyped {\n\t\tswitch( __js__(\"typeof\")(v) ) {\n\t\tcase \"boolean\": return TBool;\n\t\tcase \"string\": return TClass(String);\n\t\tcase \"number\":\n\t\t\t// this should handle all cases : NaN, +/-Inf and Floats outside range\n\t\t\tif( Math.ceil(v) == v%2147483648.0 )\n\t\t\t\treturn TInt;\n\t\t\treturn TFloat;\n\t\tcase \"object\":\n\t\t\tif( v == null )\n\t\t\t\treturn TNull;\n\t\t\tvar e = v.__enum__;\n\t\t\tif( e != null )\n\t\t\t\treturn TEnum(e);\n\t\t\tvar c = js.Boot.getClass(v);\n\t\t\tif( c != null )\n\t\t\t\treturn TClass(c);\n\t\t\treturn TObject;\n\t\tcase \"function\":\n\t\t\tif( js.Boot.isClass(v) || js.Boot.isEnum(v) )\n\t\t\t\treturn TObject;\n\t\t\treturn TFunction;\n\t\tcase \"undefined\":\n\t\t\treturn TNull;\n\t\tdefault:\n\t\t\treturn TUnknown;\n\t\t}\n\t}\n\n\tpublic static function enumEq<T>( a : T, b : T ) : Bool untyped {\n\t\tif( a == b )\n\t\t\treturn true;\n\t\ttry {\n\t\t\tif( a[0] != b[0] )\n\t\t\t\treturn false;\n\t\t\tfor( i in 2...a.length )\n\t\t\t\tif( !enumEq(a[i],b[i]) )\n\t\t\t\t\treturn false;\n\t\t\tvar e = a.__enum__;\n\t\t\tif( e != b.__enum__ || e == null )\n\t\t\t\treturn false;\n\t\t} catch( e : Dynamic ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic inline static function enumConstructor( e : EnumValue ) : String {\n\t\treturn untyped e[0];\n\t}\n\n\tpublic inline static function enumParameters( e : EnumValue ) : Array<Dynamic> {\n\t\treturn untyped e.slice(2);\n\t}\n\n\tpublic inline static function enumIndex( e : EnumValue ) : Int {\n\t\treturn untyped e[1];\n\t}\n\n\tpublic static function allEnums<T>( e : Enum<T> ) : Array<T> {\n\t\treturn untyped e.__empty_constructs__;\n\t}\n\n}\n\n","import js.html.audio.AudioContext;\nimport js.html.HTMLDocument;\nimport js.html.AudioElement;\nimport js.Browser;\n\n/**\n* Web Audio Library with HTML5 audio fallback.\n*\n* @class Waud\n*/\n@:expose @:keep class Waud {\n\n\t/**\n\t* Tells whether to use web audio api or not.\n\t*\n\t* You can use this to enable/disable web audio globally for all sounds.\n\t*\n\t* Note that you can also enable/disable web audio individually for each sound instance.\n\t*\n\t* @property useWebAudio\n\t* @static\n\t* @type {Bool}\n\t* @default true\n\t* @example\n \t*     Waud.useWebAudio = false;\n\t*/\n\tpublic static var useWebAudio:Bool = true;\n\n\t/**\n\t* Tells whether web audio api is supported or not.\n\t*\n\t* @property isWebAudioSupported\n\t* @static\n\t* @type {Bool}\n\t* @readOnly\n\t* @example\n \t*     Waud.isWebAudioSupported;\n\t*/\n\tpublic static var isWebAudioSupported(default, null):Bool;\n\n\t/**\n\t* Tells whether html5 audio is supported or not.\n\t*\n\t* @property isHTML5AudioSupported\n\t* @static\n\t* @type {Bool}\n\t* @readOnly\n\t* @example\n \t*     Waud.isHTML5AudioSupported;\n\t*/\n\tpublic static var isHTML5AudioSupported(default, null):Bool;\n\n\t/**\n\t* Defaults properties used on sound.\n\t*\n\t* @property defaults\n\t* @static\n\t* @type {WaudSoundOptions}\n\t* @default { autoplay: false, loop: false, preload: true, webaudio: true, volume: 1 }\n\t* @example\n \t*     Waud.defaults = { volume: 0.5, autoplay: true, preload: false };\n\t*/\n\tpublic static var defaults:WaudSoundOptions = {\n\t\tautoplay: false,\n\t\tloop: false,\n\t\tpreload: true,\n\t\twebaudio: true,\n\t\tvolume: 1\n\t};\n\n\t/**\n\t* Holds all the sounds that are loaded.\n\t*\n\t* @property sounds\n\t* @static\n\t* @type {Map<String, IWaudSound>}\n\t* @readOnly\n\t* @example\n \t*     Waud.sounds.get(\"url\");\n\t*/\n\tpublic static var sounds(default, null):Map<String, IWaudSound>;\n\n\t/**\n\t* Preferred sample rate used when creating buffer on audio context.\n\t*\n\t* It is recommended to use audio files with same sample rate and set the value used here.\n\t*\n\t* @property preferredSampleRate\n\t* @static\n\t* @type {Int}\n\t* @default 44100\n\t* @example\n \t*     Waud.preferredSampleRate = 22050;\n\t*/\n\tpublic static var preferredSampleRate:Int = 44100;\n\n\t/**\n\t* Audio Manager instance.\n\t*\n\t* @property audioManager\n\t* @static\n\t* @type {AudioManager}\n\t* @readOnly\n\t*/\n\tpublic static var audioManager(default, null):AudioManager;\n\n\t/**\n\t* Audio Context reference.\n\t*\n\t* @property audioContext\n\t* @static\n\t* @type {AudioContext}\n\t* @readOnly\n\t*/\n\tpublic static var audioContext:AudioContext;\n\n\t/**\n\t* Document dom element used for appending sounds and touch events.\n\t*\n\t* @property dom\n\t* @static\n\t* @type {document}\n\t*/\n\tpublic static var dom(default, null):HTMLDocument;\n\n\t/**\n\t* State of audio, muted or not.\n\t*\n\t* @property isMuted\n\t* @static\n\t* @type {Bool}\n\t* @readOnly\n\t* @default false\n\t* @example\n \t*     Waud.isMuted;\n\t*/\n\tpublic static var isMuted(default, null):Bool = false;\n\n\t/**\n\t* Touch unlock callback reference.\n\t*\n\t* @property __touchUnlockCallback\n\t* @static\n\t* @protected\n\t* @type {Function}\n\t*/\n\tpublic static var __touchUnlockCallback:Void -> Void;\n\n\t/**\n\t* Audio element used to check audio support.\n\t*\n\t* @property __audioElement\n\t* @static\n\t* @private\n\t* @type {AudioElement}\n\t* @readOnly\n\t*/\n\tstatic var __audioElement:AudioElement;\n\n\t/**\n\t* Focus Manager reference used for `autoMute` functionality.\n\t*\n\t* @property _focusManager\n\t* @static\n\t* @private\n\t* @type {WaudFocusManager}\n\t* @readOnly\n\t*/\n\tstatic var _focusManager:WaudFocusManager;\n\n\t/**\n\t* To initialise the library, make sure you call this first.\n\t*\n\t* You can also pass an optional parent DOM element to it where all the HTML5 sounds will be appended and also used for touch events to unlock audio on iOS devices.\n\t*\n\t* @static\n\t* @method init\n\t* @param {HTMLDocument} [d = document]\n\t* @example\n \t*     Waud.init();\n\t*/\n\tpublic static function init(?d:HTMLDocument) {\n\t\tif (d == null) d = Browser.document;\n\t\tdom = d;\n\t\t__audioElement = dom.createAudioElement();\n\t\tif (Waud.audioManager == null) Waud.audioManager = new AudioManager();\n\t\tisWebAudioSupported = Waud.audioManager.checkWebAudioAPISupport();\n\t\tisHTML5AudioSupported = (Reflect.field(Browser.window, \"Audio\") != null);\n\t\taudioContext = Waud.audioManager.audioContext;\n\n\t\tif (isWebAudioSupported) Waud.audioManager.createAudioContext();\n\t\telse if (!isHTML5AudioSupported) trace(\"no audio support in this browser\");\n\n\t\tsounds = new Map();\n\t}\n\n\t/**\n\t* Helper function to automatically mute audio when the browser window is not in focus.\n\t*\n\t* Will un-mute when the window gains focus.\n\t*\n\t* @static\n\t* @method autoMute\n\t* @example\n \t*     Waud.autoMute();\n\t*/\n\tpublic static function autoMute() {\n\t\tvar blur = function() {\n\t\t\tfor (sound in sounds) sound.mute(true);\n\t\t};\n\n\t\tvar focus = function() {\n\t\t\tif (!isMuted) for (sound in sounds) sound.mute(false);\n\t\t};\n\n\t\t_focusManager = new WaudFocusManager();\n\t\t_focusManager.focus = focus;\n\t\t_focusManager.blur = blur;\n\t}\n\n\t/**\n\t* Helper function to unlock audio on iOS devices.\n\t*\n\t* You can pass an optional callback which will be triggered on `touchend` event.\n\t*\n\t* @static\n\t* @method enableTouchUnlock\n\t* @param {Function} [callback] - Optional callback that triggers after touch unlock.\n\t* @example\n \t*     Waud.enableTouchUnlock(callback);\n\t*/\n\tpublic static function enableTouchUnlock(?callback:Void -> Void) {\n\t\t__touchUnlockCallback = callback;\n\t\tdom.ontouchend = Waud.audioManager.unlockAudio;\n\t}\n\n\t/**\n\t* Helper function to mute all the sounds.\n\t*\n\t* @static\n\t* @method mute\n\t* @param {Bool} [val = true]\n\t* @example\n\t*     Waud.mute();\n \t*     Waud.mute(true);\n \t*     Waud.mute(false);\n\t*/\n\tpublic static function mute(?val:Bool = true) {\n\t\tisMuted = val;\n\t\tif (sounds != null) for (sound in sounds) sound.mute(val);\n\t}\n\n\t/**\n\t* Helper function to stop all the sounds.\n\t*\n\t* @static\n\t* @method stop\n\t* @example\n\t*     Waud.stop();\n\t*/\n\tpublic static function stop() {\n\t\tif (sounds != null) for (sound in sounds) sound.stop();\n\t}\n\n\t/**\n\t* Returns a string with all the format support information.\n\t*\n\t* @static\n\t* @method getFormatSupportString\n\t* @return {String} support string `OGG: probably, WAV: probably, MP3: probably, AAC: probably, M4A: maybe` (example)\n\t* @example\n\t*     Waud.getFormatSupportString();\n\t*/\n\tpublic static function getFormatSupportString():String {\n\t\tvar support:String = \"OGG: \" + __audioElement.canPlayType('audio/ogg; codecs=\"vorbis\"');\n\t\tsupport += \", WAV: \" + __audioElement.canPlayType('audio/wav; codecs=\"1\"');\n\t\tsupport += \", MP3: \" + __audioElement.canPlayType('audio/mpeg;');\n\t\tsupport += \", AAC: \" + __audioElement.canPlayType('audio/aac;');\n\t\tsupport += \", M4A: \" + __audioElement.canPlayType('audio/x-m4a;');\n\t\treturn support;\n\t}\n\n\t/**\n\t* Function to check whether audio is supported or not.\n\t*\n\t* @static\n\t* @method isSupported\n\t* @return {Bool} true or false\n\t* @example\n\t*     Waud.isSupported();\n\t*/\n\tpublic static function isSupported():Bool {\n\t\tif (isWebAudioSupported == null || isHTML5AudioSupported == null) {\n\t\t\tisWebAudioSupported = Waud.audioManager.checkWebAudioAPISupport();\n\t\t\tisHTML5AudioSupported = (Reflect.field(Browser.window, \"Audio\") != null);\n\t\t}\n\t\treturn (isWebAudioSupported || isHTML5AudioSupported);\n\t}\n\n\t/**\n\t* Function to check `ogg` format support.\n\t*\n\t* @static\n\t* @method isOGGSupported\n\t* @return {Bool} true or false\n\t* @example\n\t*     Waud.isOGGSupported();\n\t*/\n\tpublic static function isOGGSupported():Bool {\n\t\tvar canPlay = __audioElement.canPlayType('audio/ogg; codecs=\"vorbis\"');\n\t\treturn (isHTML5AudioSupported && canPlay != null && (canPlay == \"probably\" || canPlay == \"maybe\"));\n\t}\n\n\t/**\n\t* Function to check `wav` format support.\n\t*\n\t* @static\n\t* @method isWAVSupported\n\t* @return {Bool} true or false\n\t* @example\n\t*     Waud.isWAVSupported();\n\t*/\n\tpublic static function isWAVSupported():Bool {\n\t\tvar canPlay = __audioElement.canPlayType('audio/wav; codecs=\"1\"');\n\t\treturn (isHTML5AudioSupported && canPlay != null && (canPlay == \"probably\" || canPlay == \"maybe\"));\n\t}\n\n\t/**\n\t* Function to check `mp3` format support.\n\t*\n\t* @static\n\t* @method isMP3Supported\n\t* @return {Bool} true or false\n\t* @example\n\t*     Waud.isMP3Supported();\n\t*/\n\tpublic static function isMP3Supported():Bool {\n\t\tvar canPlay = __audioElement.canPlayType('audio/mpeg;');\n\t\treturn (isHTML5AudioSupported && canPlay != null && (canPlay == \"probably\" || canPlay == \"maybe\"));\n\t}\n\n\t/**\n\t* Function to check `aac` format support.\n\t*\n\t* @static\n\t* @method isAACSupported\n\t* @return {Bool} true or false\n\t* @example\n\t*     Waud.isAACSupported();\n\t*/\n\tpublic static function isAACSupported():Bool {\n\t\tvar canPlay = __audioElement.canPlayType('audio/aac;');\n\t\treturn (isHTML5AudioSupported && canPlay != null && (canPlay == \"probably\" || canPlay == \"maybe\"));\n\t}\n\n\t/**\n\t* Function to check `m4a` format support.\n\t*\n\t* @static\n\t* @method isM4ASupported\n\t* @return {Bool} true or false\n\t* @example\n\t*     Waud.isM4ASupported();\n\t*/\n\tpublic static function isM4ASupported():Bool {\n\t\tvar canPlay = __audioElement.canPlayType('audio/x-m4a;');\n\t\treturn (isHTML5AudioSupported && canPlay != null && (canPlay == \"probably\" || canPlay == \"maybe\"));\n\t}\n\n\t/**\n\t* Function to destroy audio context.\n\t*\n\t* @static\n\t* @method destroy\n\t* @example\n\t*     Waud.destroy();\n\t*/\n\tpublic static function destroy() {\n\t\tif (sounds != null) for (sound in sounds) sound.destroy();\n\t\tsounds = null;\n\t\tif (Waud.audioManager != null) Waud.audioManager.destroy();\n\t\tWaud.audioManager = null;\n\t\tWaud.audioContext = null;\n\t\t__audioElement = null;\n\t\tif (_focusManager != null) {\n\t\t\t_focusManager.clearEvents();\n\t\t\t_focusManager.blur = null;\n\t\t\t_focusManager.focus = null;\n\t\t}\n\t}\n}","import js.Browser;\n\n@:expose @:keep class WaudFocusManager {\n\n\tstatic inline var FOCUS_STATE:String = \"focus\";\n\tstatic inline var BLUR_STATE:String = \"blur\";\n\n\t/**\n\t* Focus callback function.\n\t*\n\t* @property focus\n\t* @type {Function}\n\t* @example\n \t*     fm.focus = onFocus;\n\t*/\n\tpublic var focus:Void -> Void;\n\n\t/**\n\t* Blur callback function.\n\t*\n\t* @property blur\n\t* @type {Function}\n\t* @example\n \t*     fm.blur = onBlur;\n\t*/\n\tpublic var blur:Void -> Void;\n\n\tvar _hidden:String;\n\tvar _visibilityChange:String;\n\tvar _currentState:String;\n\n\t/**\n\t* Cross-browser utility class used to mute/unmute audio on focus on/off events. Used when **Waud.autoMute()** is called.\n\t*\n\t* This calss can also be used as a standalone utility class to handle focus on/off events.\n\t*\n\t* @class WaudFocusManager\n\t* @constructor\n\t* @example\n\t* \t\tvar fm = new WaudFocusManager();\n\t* \t\tfm.focus = onFocus;\n\t* \t\tfm.blur = onBlur;\n\t*/\n\tpublic function new() {\n\t\t_hidden = \"\";\n\t\t_visibilityChange = \"\";\n\t\t_currentState = \"\";\n\n\t\tif (Reflect.field(Browser.document, \"hidden\") != null) {\n\t\t\t_hidden = \"hidden\";\n\t\t\t_visibilityChange = \"visibilitychange\";\n\t\t}\n\t\telse if (Reflect.field(Browser.document, \"mozHidden\") != null) {\n\t\t\t_hidden = \"mozHidden\";\n\t\t\t_visibilityChange = \"mozvisibilitychange\";\n\t\t}\n\t\telse if (Reflect.field(Browser.document, \"msHidden\") != null) {\n\t\t\t_hidden = \"msHidden\";\n\t\t\t_visibilityChange = \"msvisibilitychange\";\n\t\t}\n\t\telse if (Reflect.field(Browser.document, \"webkitHidden\") != null) {\n\t\t\t_hidden = \"webkitHidden\";\n\t\t\t_visibilityChange = \"webkitvisibilitychange\";\n\t\t}\n\n\t\tif (Reflect.field(Browser.window, \"addEventListener\") != null) {\n\t\t\tuntyped __js__(\"window\").addEventListener(\"focus\", _focus);\n\t\t\tuntyped __js__(\"window\").addEventListener(\"blur\", _blur);\n\t\t\tuntyped __js__(\"window\").addEventListener(\"pageshow\", _focus);\n\t\t\tuntyped __js__(\"window\").addEventListener(\"pagehide\", _blur);\n\t\t\tuntyped __js__(\"document\").addEventListener(_visibilityChange, _handleVisibilityChange);\n\t\t}\n\t\telse if (Reflect.field(Browser.window, \"attachEvent\") != null) {\n\t\t\tuntyped __js__(\"window\").attachEvent(\"onfocus\", _focus);\n\t\t\tuntyped __js__(\"window\").attachEvent(\"onblur\", _blur);\n\t\t\tuntyped __js__(\"window\").attachEvent(\"pageshow\", _focus);\n\t\t\tuntyped __js__(\"window\").attachEvent(\"pagehide\", _blur);\n\t\t\tuntyped __js__(\"document\").attachEvent(_visibilityChange, _handleVisibilityChange);\n\t\t}\n\t\telse {\n\t\t\tBrowser.window.onload = function () {\n\t\t\t\tBrowser.window.onfocus = _focus;\n\t\t\t\tBrowser.window.onblur = _blur;\n\t\t\t\tBrowser.window.onpageshow = _focus;\n\t\t\t\tBrowser.window.onpagehide = _blur;\n\t\t\t};\n\t\t}\n\t}\n\n\t/**\n\t* Function to handle visibility change event.\n\t*\n\t* @private\n\t* @method _handleVisibilityChange\n\t*/\n\tfunction _handleVisibilityChange() {\n\t\tif (Reflect.field(Browser.document, _hidden) != null && Reflect.field(Browser.document, _hidden) && blur != null) blur();\n\t\telse if (focus != null) focus();\n\t}\n\n\t/**\n\t* Function to trigger focus callback.\n\t*\n\t* @private\n\t* @method _focus\n\t*/\n\tfunction _focus() {\n\t\tif (_currentState != FOCUS_STATE && focus != null) focus();\n\t\t_currentState = FOCUS_STATE;\n\t}\n\n\t/**\n\t* Function to trigger blur callback.\n\t*\n\t* @private\n\t* @method _blur\n\t*/\n\tfunction _blur() {\n\t\tif (_currentState != BLUR_STATE && blur != null) blur();\n\t\t_currentState = BLUR_STATE;\n\t}\n\n\t/**\n\t* Function to clear focus manager events.\n\t*\n\t* @method clearEvents\n\t* @example\n\t*     fm.clearEvents();\n\t*/\n\tpublic function clearEvents() {\n\t\tif (Reflect.field(Browser.window, \"removeEventListener\") != null) {\n\t\t\tuntyped __js__(\"window\").removeEventListener(\"focus\", _focus);\n\t\t\tuntyped __js__(\"window\").removeEventListener(\"blur\", _blur);\n\t\t\tuntyped __js__(\"window\").removeEventListener(\"pageshow\", _focus);\n\t\t\tuntyped __js__(\"window\").removeEventListener(\"pagehide\", _blur);\n\t\t\tuntyped __js__(\"window\").removeEventListener(_visibilityChange, _handleVisibilityChange);\n\t\t}\n\t\telse if (Reflect.field(Browser.window, \"removeEvent\") != null) {\n\t\t\tuntyped __js__(\"window\").removeEvent(\"onfocus\", _focus);\n\t\t\tuntyped __js__(\"window\").removeEvent(\"onblur\", _blur);\n\t\t\tuntyped __js__(\"window\").removeEvent(\"pageshow\", _focus);\n\t\t\tuntyped __js__(\"window\").removeEvent(\"pagehide\", _blur);\n\t\t\tuntyped __js__(\"window\").removeEvent(_visibilityChange, _handleVisibilityChange);\n\t\t}\n\t\telse {\n\t\t\tBrowser.window.onfocus = null;\n\t\t\tBrowser.window.onblur = null;\n\t\t\tBrowser.window.onpageshow = null;\n\t\t\tBrowser.window.onpagehide = null;\n\t\t}\n\t}\n}","import js.html.XMLHttpRequest;\nimport haxe.Json;\n\n@:expose @:keep class WaudSound implements IWaudSound {\n\n\t/**\n\t* Indicates if the sound is sprite sound or normal sound.\n\t*\n\t* @property isSpriteSound\n\t* @type {Bool}\n\t* @readOnly\n\t* @example\n \t*     snd.isSpriteSound;\n\t*/\n\tpublic var isSpriteSound:Bool;\n\n\t/**\n\t* Sound url.\n\t*\n\t* @property url\n\t* @type {String}\n\t* @readOnly\n\t* @example\n \t*     snd.url;\n\t*/\n\tpublic var url:String;\n\n\tvar _snd:IWaudSound;\n\tvar _options:WaudSoundOptions;\n\tvar _spriteData:AudioSprite;\n\n\t/**\n\t* Class to automatically use web audio api with HTML5 audio fallback.\n\t*\n\t* @class WaudSound\n\t* @constructor\n\t* @param {String} url - Can be audio file path or JSON file for audio sprite.\n\t* @param {WaudSoundOptions} [options] - Sound options.\n\t* @example\n\t* \t\t// MP3 Sound\n\t* \t\tvar snd = new WaudSound(\"assets/loop.mp3\", { autoplay: false, loop: true, volume: 0.5, onload: _playBgSound });\n\t*\n\t* \t\t// Force HTML5 Audio\n\t* \t\tvar snd = new WaudSound(\"assets/loop.mp3\", { webaudio: false });\n\t*\n\t* \t\t// Audio Sprite\n\t* \t\tvar audSprite = new WaudSound(\"assets/sprite.json\");\n\t* \t\taudSprite.play(\"glass\");\n\t*/\n\tpublic function new(url:String, ?options:WaudSoundOptions = null) {\n\t\tif (Waud.audioManager == null) {\n\t\t\ttrace(\"initialise Waud using Waud.init() before loading sounds\");\n\t\t\treturn;\n\t\t}\n\n\t\t_options = options;\n\n\t\tif (url.indexOf(\".json\") > 0) {\n\t\t\tisSpriteSound = true;\n\t\t\t_loadSpriteJson(url);\n\t\t}\n\t\telse {\n\t\t\tisSpriteSound = false;\n\t\t\t_init(url);\n\t\t}\n\n\t\tWaud.sounds.set(url, this);\n\t}\n\n\t/**\n\t* Function to load audio sprite JSON.\n\t*\n\t* @private\n\t* @method _loadSpriteJson\n\t* @param {String} url - Audio Sprite JSON path.\n\t*/\n\tfunction _loadSpriteJson(url:String) {\n\t\tvar xobj = new XMLHttpRequest();\n\t\txobj.overrideMimeType(\"application/json\");\n\t\txobj.open(\"GET\", url, true);\n\t\txobj.onreadystatechange = function() {\n\t\t\tif (xobj.readyState == 4 && xobj.status == 200) {\n\t\t\t\t_spriteData = Json.parse(xobj.response);\n\t\t\t\t_init(_spriteData.src);\n\t\t\t}\n\t\t};\n\t\txobj.send(null);\n\t}\n\n\t/**\n\t* Function to initialize sound.\n\t*\n\t* @private\n\t* @method _init\n\t* @param {String} url - Audio file path.\n\t*/\n\tfunction _init(url:String) {\n\t\tthis.url = url;\n\t\tif (Waud.isWebAudioSupported && Waud.useWebAudio && (_options == null || _options.webaudio == null || _options.webaudio)) _snd = new WebAudioAPISound(url, _options);\n\t\telse if (Waud.isHTML5AudioSupported) _snd = new HTML5Sound(url, _options);\n\t\telse trace(\"no audio support in this browser\");\n\n\t\t_snd.isSpriteSound = isSpriteSound;\n\t}\n\n\t/**\n\t* Function to set sound volume.\n\t*\n\t* @method setVolume\n\t* @param {Float} val - Should be between 0 and 1.\n\t* @example\n\t*     snd.setVolume(0.5);\n\t*/\n\tpublic function setVolume(val:Float) {\n\t\tif (_snd == null) return;\n\t\t_snd.setVolume(val);\n\t}\n\n\t/**\n\t* Function to get sound volume.\n\t*\n\t* @method getVolume\n\t* @return {Float} between 0 and 1\n\t* @example\n\t*     snd.getVolume();\n\t*/\n\tpublic function getVolume():Float {\n\t\tif (_snd == null) return 0;\n\t\treturn _snd.getVolume();\n\t}\n\n\t/**\n\t* Function to mute sound.\n\t*\n\t* @method mute\n\t* @param {Bool} val\n\t* @example\n\t*     snd.mute(true);\n\t*/\n\tpublic function mute(val:Bool) {\n\t\tif (_snd == null) return;\n\t\t_snd.mute(val);\n\t}\n\n\t/**\n\t* Function to manually load the sound if `preload` was set to `false` with optional onload callback.\n\t*\n\t* @method load\n\t* @param {Function} [callback] - onload callback function.\n\t* @return {IWaudSound} sound instance\n\t* @example\n\t*     snd.load();\n\t*     snd.load(callback);\n\t*/\n\tpublic function load(?callback:IWaudSound -> Void):IWaudSound {\n\t\tif (_snd == null) return null;\n\t\t_snd.load(callback);\n\t\treturn this;\n\t}\n\n\t/**\n\t* Function to play the sound with optional sprite name when using audio sprite.\n\t*\n\t* @method play\n\t* @param {String} [spriteName] - Sprite name to play.\n\t* @return {IWaudSound} sound instance\n\t* @example\n\t*     snd.play();\n\t*     snd.play(\"bell\");\n\t*/\n\tpublic function play(?spriteName:String, ?soundProps:AudioSpriteSoundProperties = null):IWaudSound {\n\t\tif (_snd == null) return null;\n\t\tif (spriteName != null) {\n\t\t\tfor (snd in _spriteData.sprite) {\n\t\t\t\tif (snd.name == spriteName) {\n\t\t\t\t\tsoundProps = snd;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_snd.play(spriteName, soundProps);\n\t\treturn this;\n\t}\n\n\t/**\n\t* Function to check if the sound is playing or not.\n\t*\n\t* @method isPlaying\n\t* @return {Bool} true or false\n\t* @example\n\t*     snd.isPlaying();\n\t*/\n\tpublic function isPlaying():Bool {\n\t\tif (_snd == null) return false;\n\t\treturn _snd.isPlaying();\n\t}\n\n\t/**\n\t* Function to loop or unloop sound.\n\t*\n\t* @method loop\n\t* @param {Bool} val\n\t* @example\n\t*     snd.loop(true);\n\t*/\n\tpublic function loop(val:Bool) {\n\t\tif (_snd == null) return;\n\t\t_snd.loop(val);\n\t}\n\n\t/**\n\t* Function to stop sound.\n\t*\n\t* @method stop\n\t* @example\n\t*     snd.stop();\n\t*/\n\tpublic function stop() {\n\t\tif (_snd == null) return;\n\t\t_snd.stop();\n\t}\n\n\t/**\n\t* Function to add callback that triggers when the sound finishes playing.\n\t*\n\t* @method onEnd\n\t* @param {Function} callback - Callback function.\n\t* @return {IWaudSound} sound instance\n\t* @example\n\t*     snd.onEnd(callback);\n\t*/\n\tpublic function onEnd(callback:IWaudSound -> Void):IWaudSound {\n\t\tif (_snd == null) return null;\n\t\t_snd.onEnd(callback);\n\t\treturn this;\n\t}\n\n\t/**\n\t* Function to add callback that triggers when the sound is loaded.\n\t*\n\t* @method onLoad\n\t* @param {Function} callback - Callback function.\n\t* @return {IWaudSound} sound instance\n\t* @example\n\t*     snd.onLoad(callback);\n\t*/\n\tpublic function onLoad(callback:IWaudSound -> Void):IWaudSound {\n\t\tif (_snd == null) return null;\n\t\t_snd.onLoad(callback);\n\t\treturn this;\n\t}\n\n\t/**\n\t* Function to destroy sound.\n\t*\n\t* @method destroy\n\t* @example\n\t*     snd.destroy();\n\t*/\n\tpublic function destroy() {\n\t\tif (_snd == null) return;\n\t\t_snd.destroy();\n\t\t_snd = null;\n\t}\n}","import js.Browser;\n\n/**\n* Collection of Browser Utility Functions.\n*\n* @class WaudUtils\n*/\n@:expose @:keep class WaudUtils {\n\n\t/**\n\t* User Agrent String.\n\t*\n\t* @static\n\t* @property ua\n\t* @type {String}\n\t* @example\n\t*     WaudUtils.ua;\n\t*/\n\tpublic static var ua:String = Browser.navigator.userAgent;\n\n\t/**\n\t* Function to check if the device is **Android** or not.\n\t*\n\t* @static\n\t* @method isAndroid\n\t* @return {Bool} true or false\n\t* @example\n\t*     Waud.isAndroid();\n\t*/\n\tpublic static function isAndroid():Bool {\n\t\treturn ~/Android/i.match(ua);\n\t}\n\n\t/**\n\t* Function to check if the device is **iOS** or not.\n\t*\n\t* @static\n\t* @method isiOS\n\t* @return {Bool} true or false\n\t* @example\n\t*     Waud.isiOS();\n\t*/\n\tpublic static function isiOS():Bool {\n\t\treturn ~/(iPad|iPhone|iPod)/i.match(ua);\n\t}\n\n\t/**\n\t* Function to check if the device is **Windows Phone** or not.\n\t*\n\t* @static\n\t* @method isWindowsPhone\n\t* @return {Bool} true or false\n\t* @example\n\t*     Waud.isWindowsPhone();\n\t*/\n\tpublic static function isWindowsPhone():Bool {\n\t\treturn ~/(IEMobile|Windows Phone)/i.match(ua);\n\t}\n\n\t/**\n\t* Function to check if the device is **Firefox** or not.\n\t*\n\t* @static\n\t* @method isFirefox\n\t* @return {Bool} true or false\n\t* @example\n\t*     Waud.isFirefox();\n\t*/\n\tpublic static function isFirefox():Bool {\n\t\treturn ~/Firefox/i.match(ua);\n\t}\n\n\t/**\n\t* Function to check if the device is **Opera** or not.\n\t*\n\t* @static\n\t* @method isOpera\n\t* @return {Bool} true or false\n\t* @example\n\t*     Waud.isOpera();\n\t*/\n\tpublic static function isOpera():Bool {\n\t\treturn ~/Opera/i.match(ua) || Reflect.field(Browser.window, \"opera\") != null;\n\t}\n\n\t/**\n\t* Function to check if the device is **Chrome** or not.\n\t*\n\t* @static\n\t* @method isChrome\n\t* @return {Bool} true or false\n\t* @example\n\t*     Waud.isChrome();\n\t*/\n\tpublic static function isChrome():Bool {\n\t\treturn ~/Chrome/i.match(ua);\n\t}\n\n\t/**\n\t* Function to check if the device is **Safari** or not.\n\t*\n\t* @static\n\t* @method isSafari\n\t* @return {Bool} true or false\n\t* @example\n\t*     Waud.isSafari();\n\t*/\n\tpublic static function isSafari():Bool {\n\t\treturn ~/Safari/i.match(ua);\n\t}\n\n\t/**\n\t* Function to check if the device is **mobile** or not.\n\t*\n\t* @static\n\t* @method isMobile\n\t* @return {Bool} true or false\n\t* @example\n\t*     Waud.isMobile();\n\t*/\n\tpublic static function isMobile():Bool {\n\t\treturn ~/(iPad|iPhone|iPod|Android|webOS|BlackBerry|Windows Phone|IEMobile)/i.match(ua);\n\t}\n\n\t/**\n\t* Function to get the **iOS** version.\n\t*\n\t* @static\n\t* @method getiOSVersion\n\t* @return {Array<Int>} [9,0,1]\n\t* @example\n\t*     Waud.getiOSVersion();\n\t*/\n\tpublic static function getiOSVersion():Array<Int> {\n\t\tvar v:EReg = ~/[0-9_]+?[0-9_]+?[0-9_]+/i;\n\t\tvar matched:Array<Int> = [];\n\t\tif (v.match(ua)) {\n\t\t\tvar match:Array<String> = v.matched(0).split(\"_\");\n\t\t\tmatched = [for (i in match) Std.parseInt(i)];\n\t\t}\n\t\treturn matched;\n\t}\n}","import js.html.XMLHttpRequestResponseType;\nimport js.html.XMLHttpRequest;\nimport js.html.audio.GainNode;\nimport js.html.audio.AudioBufferSourceNode;\nimport js.html.audio.AudioBuffer;\n\n@:keep class WebAudioAPISound extends BaseSound implements IWaudSound {\n\n\tvar _manager:AudioManager;\n\tvar _snd:AudioBufferSourceNode;\n\tvar _gainNode:GainNode;\n\n\tpublic function new(url:String, ?options:WaudSoundOptions = null) {\n\t\t#if debug trace(\"using web audio - \" + url); #end\n\t\tsuper(url, options);\n\t\t_manager = Waud.audioManager;\n\t\tif (_options.preload) load();\n\t}\n\n\tfunction _onSoundLoaded(evt) {\n\t\t_manager.audioContext.decodeAudioData(evt.target.response, _decodeSuccess, _error);\n\t}\n\n\tfunction _decodeSuccess(buffer:AudioBuffer) {\n\t\tif (buffer == null) {\n\t\t\ttrace(\"empty buffer: \" + url);\n\t\t\t_error();\n\t\t\treturn;\n\t\t}\n\t\t_manager.bufferList.set(url, buffer);\n\t\t_isLoaded = true;\n\t\tif (_options.onload != null) _options.onload(this);\n\t\tif (_options.autoplay) play();\n\t}\n\n\tinline function _error() {\n\t\tif (_options.onerror != null) _options.onerror(this);\n\t}\n\n\tfunction _makeSource(buffer:AudioBuffer):AudioBufferSourceNode {\n\t\tvar source:AudioBufferSourceNode = _manager.audioContext.createBufferSource();\n\t\t_gainNode = _manager.audioContext.createGain();\n\t\t_gainNode.gain.value = _options.volume;\n\t\tsource.buffer = buffer;\n\t\tsource.connect(_gainNode);\n\t\t_gainNode.connect(_manager.audioContext.destination);\n\t\treturn source;\n\t}\n\n\tpublic function load(?callback:IWaudSound -> Void):IWaudSound {\n\t\tif (!_isLoaded) {\n\t\t\tvar request = new XMLHttpRequest();\n\t\t\trequest.open(\"GET\", url, true);\n\t\t\trequest.responseType = XMLHttpRequestResponseType.ARRAYBUFFER;\n\t\t\trequest.onload = _onSoundLoaded;\n\t\t\trequest.onerror = _error;\n\t\t\trequest.send();\n\n\t\t\tif (callback != null) _options.onload = callback;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tpublic function play(?spriteName:String, ?soundProps:AudioSpriteSoundProperties):IWaudSound {\n\t\tif (!_isLoaded) {\n\t\t\ttrace(\"sound not loaded\");\n\t\t\treturn this;\n\t\t}\n\t\tif (_muted) return this;\n\t\tvar start:Float = 0;\n\t\tvar end:Float = -1;\n\t\tif (isSpriteSound && soundProps != null) {\n\t\t\tstart = soundProps.start;\n\t\t\tend = soundProps.duration;\n\t\t}\n\t\tvar buffer = _manager.bufferList.get(url);\n\t\tif (buffer != null) {\n\t\t\t_snd = _makeSource(buffer);\n\t\t\tif (start >= 0 && end > -1) _snd.start(0, start, end);\n\t\t\telse {\n\t\t\t\t_snd.loop = _options.loop;\n\t\t\t\t_snd.start(0);\n\t\t\t}\n\n\t\t\t_isPlaying = true;\n\t\t\t_snd.onended = function() {\n\t\t\t\tif (isSpriteSound && soundProps != null && soundProps.loop && start >= 0 && end > -1) {\n\t\t\t\t\tplay(spriteName, soundProps);\n\t\t\t\t}\n\t\t\t\t_isPlaying = false;\n\t\t\t\tif (_options.onend != null) _options.onend(this);\n\t\t\t}\n\n\t\t\tif(_manager.playingSounds.get(url) == null) _manager.playingSounds.set(url, _snd);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tpublic function isPlaying():Bool {\n\t\treturn _isPlaying;\n\t}\n\n\tpublic function loop(val:Bool) {\n\t\tif (_snd == null || !_isLoaded) return;\n\t\t_snd.loop = val;\n\t}\n\n\tpublic function setVolume(val:Float) {\n\t\tif (_gainNode == null || !_isLoaded) return;\n\t\t_options.volume = val;\n\t\t_gainNode.gain.value = _options.volume;\n\t}\n\n\tpublic function getVolume():Float {\n\t\treturn _options.volume;\n\t}\n\n\tpublic function mute(val:Bool) {\n\t\t_muted = val;\n\t\tif (_gainNode == null || !_isLoaded) return;\n\t\tif (val) _gainNode.gain.value = 0;\n\t\telse _gainNode.gain.value = _options.volume;\n\t}\n\n\tpublic function stop() {\n\t\tif (_snd == null || !_isLoaded) return;\n\t\t_snd.stop(0);\n\t}\n\n\tpublic function onEnd(callback:IWaudSound -> Void):IWaudSound {\n\t\t_options.onend = callback;\n\t\treturn this;\n\t}\n\n\tpublic function onLoad(callback:IWaudSound -> Void):IWaudSound {\n\t\t_options.onload = callback;\n\t\treturn this;\n\t}\n\n\tpublic function destroy() {\n\t\tif (_snd != null) {\n\t\t\t_snd.stop(0);\n\t\t\t_snd.disconnect();\n\t\t\t_snd = null;\n\t\t}\n\t\tif (_gainNode != null) {\n\t\t\t_gainNode.disconnect();\n\t\t\t_gainNode = null;\n\t\t}\n\t}\n}","/*\n * Copyright (C)2005-2013 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe;\n\n/**\n\tThe Timer class allows you to create asynchronous timers on platforms that\n\tsupport events.\n\n\tThe intended usage is to create an instance of the Timer class with a given\n\tinterval, set its run() method to a custom function to be invoked and\n\teventually call stop() to stop the Timer.\n\n\tNote that a running Timer may or may not prevent the program to exit\n\tautomatically when main() returns.\n\n\tIt is also possible to extend this class and override its run() method in\n\tthe child class.\n**/\nclass Timer {\n\t#if (flash || js || java || python)\n\n\t#if (flash || js)\n\t\tprivate var id : Null<Int>;\n\t#elseif java\n\t\tprivate var timer : java.util.Timer;\n\t\tprivate var task : java.util.TimerTask;\n\t#end\n\n\t/**\n\t\tCreates a new timer that will run every `time_ms` milliseconds.\n\n\t\tAfter creating the Timer instance, it calls `this].run` repeatedly,\n\t\twith delays of `time_ms` milliseconds, until `this.stop` is called.\n\n\t\tThe first invocation occurs after `time_ms` milliseconds, not\n\t\timmediately.\n\n\t\tThe accuracy of this may be platform-dependent.\n\t**/\n\tpublic function new( time_ms : Int ){\n\t\t#if flash\n\t\t\tvar me = this;\n\t\t\tid = untyped __global__[\"flash.utils.setInterval\"](function() { me.run(); },time_ms);\n\t\t#elseif js\n\t\t\tvar me = this;\n\t\t\tid = untyped setInterval(function() me.run(),time_ms);\n\t\t#elseif java\n\t\t\ttimer = new java.util.Timer();\n\t\t\ttimer.scheduleAtFixedRate(task = new TimerTask(this), haxe.Int64.ofInt(time_ms), haxe.Int64.ofInt(time_ms));\n\t\t#end\n\t}\n\n\t/**\n\t\tStops `this` Timer.\n\n\t\tAfter calling this method, no additional invocations of `this.run`\n\t\twill occur.\n\n\t\tIt is not possible to restart `this` Timer once stopped.\n\t**/\n\tpublic function stop() {\n\t\t#if (flash || js)\n\t\t\tif( id == null )\n\t\t\t\treturn;\n\t\t\t#if flash\n\t\t\t\tuntyped __global__[\"flash.utils.clearInterval\"](id);\n\t\t\t#elseif js\n\t\t\t\tuntyped clearInterval(id);\n\t\t\t#end\n\t\t\tid = null;\n\t\t#elseif java\n\t\t\ttimer.cancel();\n\t\t\ttimer = null;\n\t\t\ttask = null;\n\t\t#end\n\t}\n\n\t/**\n\t\tThis method is invoked repeatedly on `this` Timer.\n\n\t\tIt can be overridden in a subclass, or rebound directly to a custom\n\t\tfunction:\n\t\t\tvar timer = new haxe.Timer(1000); // 1000ms delay\n\t\t\ttimer.run = function() { ... }\n\n\t\tOnce bound, it can still be rebound to different functions until `this`\n\t\tTimer is stopped through a call to `this.stop`.\n\t**/\n\tpublic dynamic function run() {\n\n\t}\n\n\t/**\n\t\tInvokes `f` after `time_ms` milliseconds.\n\n\t\tThis is a convenience function for creating a new Timer instance with\n\t\t`time_ms` as argument, binding its run() method to `f` and then stopping\n\t\t`this` Timer upon the first invocation.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function delay( f : Void -> Void, time_ms : Int ) {\n\t\tvar t = new haxe.Timer(time_ms);\n\t\tt.run = function() {\n\t\t\tt.stop();\n\t\t\tf();\n\t\t};\n\t\treturn t;\n\t}\n\n\t#end\n\n\t/**\n\t\tMeasures the time it takes to execute `f`, in seconds with fractions.\n\n\t\tThis is a convenience function for calculating the difference between\n\t\tTimer.stamp() before and after the invocation of `f`.\n\n\t\tThe difference is passed as argument to Log.trace(), with \"s\" appended\n\t\tto denote the unit. The optional `pos` argument is passed through.\n\n\t\tIf `f` is null, the result is unspecified.\n\t**/\n\tpublic static function measure<T>( f : Void -> T, ?pos : PosInfos ) : T {\n\t\tvar t0 = stamp();\n\t\tvar r = f();\n\t\tLog.trace((stamp() - t0) + \"s\", pos);\n\t\treturn r;\n\t}\n\n\t/**\n\t\tReturns a timestamp, in seconds with fractions.\n\n\t\tThe value itself might differ depending on platforms, only differences\n\t\tbetween two values make sense.\n\t**/\n\tpublic static function stamp() : Float {\n\t\t#if flash\n\t\t\treturn flash.Lib.getTimer() / 1000;\n\t\t#elseif (neko || php)\n\t\t\treturn Sys.time();\n\t\t#elseif js\n\t\t\treturn Date.now().getTime() / 1000;\n\t\t#elseif cpp\n\t\t\treturn untyped __global__.__time_stamp();\n\t\t#elseif sys\n\t\t\treturn Sys.time();\n\t\t#else\n\t\t\treturn 0;\n\t\t#end\n\t}\n\n}\n\n#if java\n@:nativeGen\nprivate class TimerTask extends java.util.TimerTask {\n\tvar timer:Timer;\n\tpublic function new(timer:Timer):Void {\n\t\tsuper();\n\t\tthis.timer = timer;\n\t}\n\n\t@:overload override public function run():Void {\n\t\ttimer.run();\n\t}\n}\n#end\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage haxe.ds;\n\nprivate class StringMapIterator<T> {\n\tvar map : StringMap<T>;\n\tvar keys : Array<String>;\n\tvar index : Int;\n\tvar count : Int;\n\tpublic inline function new(map:StringMap<T>, keys:Array<String>) {\n\t\tthis.map = map;\n\t\tthis.keys = keys;\n\t\tthis.index = 0;\n\t\tthis.count = keys.length;\n\t}\n\tpublic inline function hasNext() {\n\t\treturn index < count;\n\t}\n\tpublic inline function next() {\n\t\treturn map.get(keys[index++]);\n\t}\n}\n\n@:coreApi class StringMap<T> implements haxe.Constraints.IMap<String,T> {\n\n\tprivate var h : Dynamic;\n\tprivate var rh : Dynamic;\n\n\tpublic inline function new() : Void {\n\t\th = {};\n\t}\n\n\tinline function isReserved(key:String) : Bool {\n\t\treturn untyped __js__(\"__map_reserved\")[key] != null;\n\t}\n\n\tpublic inline function set( key : String, value : T ) : Void {\n\t\tif( isReserved(key) )\n\t\t\tsetReserved(key, value);\n\t\telse\n\t\t\th[cast key] = value;\n\t}\n\n\tpublic inline function get( key : String ) : Null<T> {\n\t\tif( isReserved(key) )\n\t\t\treturn getReserved(key);\n\t\treturn h[cast key];\n\t}\n\n\tpublic inline function exists( key : String ) : Bool {\n\t\tif( isReserved(key) )\n\t\t\treturn existsReserved(key);\n\t\treturn h.hasOwnProperty(key);\n\t}\n\n\tfunction setReserved( key : String, value : T ) : Void {\n\t\tif( rh == null ) rh = {};\n\t\trh[cast \"$\"+key] = value;\n\t}\n\n\tfunction getReserved( key : String ) : Null<T> {\n\t\treturn rh == null ? null : rh[cast \"$\"+key];\n\t}\n\n\tfunction existsReserved( key : String ) : Bool {\n\t\tif( rh == null ) return false;\n\t\treturn untyped rh.hasOwnProperty(\"$\"+key);\n\t}\n\n\tpublic function remove( key : String ) : Bool {\n\t\tif( isReserved(key) ) {\n\t\t\tkey = \"$\" + key;\n\t\t\tif( rh == null || !rh.hasOwnProperty(key) ) return false;\n\t\t\tuntyped __js__(\"delete\")(rh[key]);\n\t\t\treturn true;\n\t\t} else {\n\t\t\tif( !h.hasOwnProperty(key) )\n\t\t\t\treturn false;\n\t\t\tuntyped __js__(\"delete\")(h[key]);\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tpublic function keys() : Iterator<String> {\n\t\treturn arrayKeys().iterator();\n\t}\n\t\n\tfunction arrayKeys() : Array<String> {\n\t\tvar out = [];\n\t\tuntyped {\n\t\t\t__js__(\"for( var key in this.h ) {\");\n\t\t\t\tif( h.hasOwnProperty(key) )\n\t\t\t\t\tout.push(key);\n\t\t\t__js__(\"}\");\n\t\t}\n\t\tif( rh != null ) untyped {\n\t\t\t__js__(\"for( var key in this.rh ) {\");\n\t\t\t\tif( key.charCodeAt(0) == \"$\".code )\n\t\t\t\t\tout.push(key.substr(1));\n\t\t\t__js__(\"}\");\n\t\t}\n\t\treturn out;\n\t}\n\n\tpublic inline function iterator() : Iterator<T> {\n\t\treturn new StringMapIterator(this, arrayKeys());\n\t}\n\n\tpublic function toString() : String {\n\t\tvar s = new StringBuf();\n\t\ts.add(\"{\");\n\t\tvar keys = arrayKeys();\n\t\tfor( i in 0...keys.length ) {\n\t\t\tvar k = keys[i];\n\t\t\ts.add(k);\n\t\t\ts.add(\" => \");\n\t\t\ts.add(Std.string(get(k)));\n\t\t\tif( i < keys.length )\n\t\t\t\ts.add(\", \");\n\t\t}\n\t\ts.add(\"}\");\n\t\treturn s.toString();\n\t}\n\n\tstatic function __init__() : Void {\n\t\tuntyped __js__(\"var __map_reserved = {}\");\n\t}\n\n}\n","/*\n * Copyright (C)2005-2012 Haxe Foundation\n *\n * Permission is hereby granted, free of charge, to any person obtaining a\n * copy of this software and associated documentation files (the \"Software\"),\n * to deal in the Software without restriction, including without limitation\n * the rights to use, copy, modify, merge, publish, distribute, sublicense,\n * and/or sell copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER\n * DEALINGS IN THE SOFTWARE.\n */\npackage js;\n\nprivate class HaxeError extends js.Error {\n\n\tvar val:Dynamic;\n\n\tpublic function new(val:Dynamic) untyped {\n\t\tsuper();\n\t\tthis.val = __define_feature__(\"js.Boot.HaxeError\", val);\n\t\tthis.message = String(val);\n\t\tif (js.Error.captureStackTrace) js.Error.captureStackTrace(this, HaxeError);\n\t}\n}\n\n@:dox(hide)\nclass Boot {\n\n\tprivate static function __unhtml(s : String) {\n\t\treturn s.split(\"&\").join(\"&amp;\").split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\");\n\t}\n\n\tprivate static function __trace(v,i : haxe.PosInfos) {\n\t\tuntyped {\n\t\t\tvar msg = if( i != null ) i.fileName+\":\"+i.lineNumber+\": \" else \"\";\n\t\t\t#if jsfl\n\t\t\tmsg += __string_rec(v,\"\");\n\t\t\tfl.trace(msg);\n\t\t\t#else\n\t\t\tmsg += __string_rec(v, \"\");\n\t\t\tif( i != null && i.customParams != null )\n\t\t\t\tfor( v in i.customParams )\n\t\t\t\t\tmsg += \",\" + __string_rec(v, \"\");\n\t\t\tvar d;\n\t\t\tif( __js__(\"typeof\")(document) != \"undefined\" && (d = document.getElementById(\"haxe:trace\")) != null )\n\t\t\t\td.innerHTML += __unhtml(msg)+\"<br/>\";\n\t\t\telse if( __js__(\"typeof console\") != \"undefined\" && __js__(\"console\").log != null )\n\t\t\t\t__js__(\"console\").log(msg);\n\t\t\t#end\n\t\t}\n\t}\n\n\tprivate static function __clear_trace() {\n\t\tuntyped {\n\t\t\t#if jsfl\n\t\t\tfl.outputPanel.clear();\n\t\t\t#else\n\t\t\tvar d = document.getElementById(\"haxe:trace\");\n\t\t\tif( d != null )\n\t\t\t\td.innerHTML = \"\";\n\t\t\t#end\n\t\t}\n\t}\n\n\tstatic inline function isClass(o:Dynamic) : Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isClass\", o.__name__);\n\t}\n\n\tstatic inline function isEnum(e:Dynamic) : Bool {\n\t\treturn untyped __define_feature__(\"js.Boot.isEnum\", e.__ename__);\n\t}\n\n\tstatic function getClass(o:Dynamic) : Dynamic {\n\t\tif (Std.is(o, Array))\n\t\t\treturn Array;\n\t\telse {\n\t\t\tvar cl = untyped __define_feature__(\"js.Boot.getClass\", o.__class__);\n\t\t\tif (cl != null)\n\t\t\t\treturn cl;\n\t\t\tvar name = __nativeClassName(o);\n\t\t\tif (name != null)\n\t\t\t\treturn __resolveNativeClass(name);\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t@:ifFeature(\"has_enum\")\n\tprivate static function __string_rec(o,s:String) {\n\t\tuntyped {\n\t\t\tif( o == null )\n\t\t\t    return \"null\";\n\t\t\tif( s.length >= 5 )\n\t\t\t\treturn \"<...>\"; // too much deep recursion\n\t\t\tvar t = __js__(\"typeof(o)\");\n\t\t\tif( t == \"function\" && (isClass(o) || isEnum(o)) )\n\t\t\t\tt = \"object\";\n\t\t\tswitch( t ) {\n\t\t\tcase \"object\":\n\t\t\t\tif( __js__(\"o instanceof Array\") ) {\n\t\t\t\t\tif( o.__enum__ ) {\n\t\t\t\t\t\tif( o.length == 2 )\n\t\t\t\t\t\t\treturn o[0];\n\t\t\t\t\t\tvar str = o[0]+\"(\";\n\t\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\t\tfor( i in 2...o.length ) {\n\t\t\t\t\t\t\tif( i != 2 )\n\t\t\t\t\t\t\t\tstr += \",\" + __string_rec(o[i],s);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tstr += __string_rec(o[i],s);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn str + \")\";\n\t\t\t\t\t}\n\t\t\t\t\tvar l = o.length;\n\t\t\t\t\tvar i;\n\t\t\t\t\tvar str = \"[\";\n\t\t\t\t\ts += \"\\t\";\n\t\t\t\t\tfor( i in 0...l )\n\t\t\t\t\t\tstr += (if (i > 0) \",\" else \"\")+__string_rec(o[i],s);\n\t\t\t\t\tstr += \"]\";\n\t\t\t\t\treturn str;\n\t\t\t\t}\n\t\t\t\tvar tostr;\n\t\t\t\ttry {\n\t\t\t\t\ttostr = untyped o.toString;\n\t\t\t\t} catch( e : Dynamic ) {\n\t\t\t\t\t// strange error on IE\n\t\t\t\t\treturn \"???\";\n\t\t\t\t}\n\t\t\t\tif( tostr != null && tostr != __js__(\"Object.toString\") && __typeof__(tostr) == \"function\" ) {\n\t\t\t\t\tvar s2 = o.toString();\n\t\t\t\t\tif( s2 != \"[object Object]\")\n\t\t\t\t\t\treturn s2;\n\t\t\t\t}\n\t\t\t\tvar k : String = null;\n\t\t\t\tvar str = \"{\\n\";\n\t\t\t\ts += \"\\t\";\n\t\t\t\tvar hasp = (o.hasOwnProperty != null);\n\t\t\t\t__js__(\"for( var k in o ) {\");\n\t\t\t\t\tif( hasp && !o.hasOwnProperty(k) )\n\t\t\t\t\t\t__js__(\"continue\");\n\t\t\t\t\tif( k == \"prototype\" || k == \"__class__\" || k == \"__super__\" || k == \"__interfaces__\" || k == \"__properties__\" )\n\t\t\t\t\t\t__js__(\"continue\");\n\t\t\t\t\tif( str.length != 2 )\n\t\t\t\t\t\tstr += \", \\n\";\n\t\t\t\t\tstr += s + k + \" : \"+__string_rec(o[k],s);\n\t\t\t\t__js__(\"}\");\n\t\t\t\ts = s.substring(1);\n\t\t\t\tstr += \"\\n\" + s + \"}\";\n\t\t\t\treturn str;\n\t\t\tcase \"function\":\n\t\t\t\treturn \"<function>\";\n\t\t\tcase \"string\":\n\t\t\t\treturn o;\n\t\t\tdefault:\n\t\t\t\treturn String(o);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate static function __interfLoop(cc : Dynamic,cl : Dynamic) {\n\t\tif( cc == null )\n\t\t\treturn false;\n\t\tif( cc == cl )\n\t\t\treturn true;\n\t\tvar intf : Dynamic = cc.__interfaces__;\n\t\tif( intf != null )\n\t\t\tfor( i in 0...intf.length ) {\n\t\t\t\tvar i : Dynamic = intf[i];\n\t\t\t\tif( i == cl || __interfLoop(i,cl) )\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\treturn __interfLoop(cc.__super__,cl);\n\t}\n\n\t@:ifFeature(\"typed_catch\") private static function __instanceof(o : Dynamic,cl : Dynamic) {\n\t\tif( cl == null )\n\t\t\treturn false;\n\t\tswitch( cl ) {\n\t\tcase Int:\n\t\t\treturn (untyped __js__(\"(o|0) === o\"));\n\t\tcase Float:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"number\";\n\t\tcase Bool:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"boolean\";\n\t\tcase String:\n\t\t\treturn (untyped __js__(\"typeof\"))(o) == \"string\";\n\t\tcase Array:\n\t\t\treturn (untyped __js__(\"(o instanceof Array)\")) && o.__enum__ == null;\n\t\tcase Dynamic:\n\t\t\treturn true;\n\t\tdefault:\n\t\t\tif( o != null ) {\n\t\t\t\t// Check if o is an instance of a Haxe class or a native JS object\n\t\t\t\tif( (untyped __js__(\"typeof\"))(cl) == \"function\" ) {\n\t\t\t\t\tif( untyped __js__(\"o instanceof cl\") )\n\t\t\t\t\t\treturn true;\n\t\t\t\t\tif( __interfLoop(getClass(o),cl) )\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\telse if ( (untyped __js__(\"typeof\"))(cl) == \"object\" && __isNativeObj(cl) ) {\n\t\t\t\t\tif( untyped __js__(\"o instanceof cl\") )\n\t\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// do not use isClass/isEnum here\n\t\t\tuntyped __feature__(\"Class.*\",if( cl == Class && o.__name__ != null ) return true);\n\t\t\tuntyped __feature__(\"Enum.*\",if( cl == Enum && o.__ename__ != null ) return true);\n\t\t\treturn o.__enum__ == cl;\n\t\t}\n\t}\n\n\t@:ifFeature(\"typed_cast\") private static function __cast(o : Dynamic, t : Dynamic) {\n\t\tif (__instanceof(o, t)) return o;\n\t\telse throw \"Cannot cast \" +Std.string(o) + \" to \" +Std.string(t);\n\t}\n\n\tstatic var __toStr = untyped __js__(\"{}.toString\");\n\t// get native JS [[Class]]\n\tstatic function __nativeClassName(o:Dynamic):String {\n\t\tvar name = untyped __toStr.call(o).slice(8, -1);\n\t\t// exclude general Object and Function\n\t\t// also exclude Math and JSON, because instanceof cannot be called on them\n\t\tif (name == \"Object\" || name == \"Function\" || name == \"Math\" || name == \"JSON\")\n\t\t\treturn null;\n\t\treturn name;\n\t}\n\n\t// check for usable native JS object\n\tstatic function __isNativeObj(o:Dynamic):Bool {\n\t\treturn __nativeClassName(o) != null;\n\t}\n\n\t// resolve native JS class in the global scope:\n\tstatic function __resolveNativeClass(name:String) untyped {\n\t\treturn untyped Function('return typeof $name != \"undefined\" ? $name : null')();\n\t}\n\n}\n","/*\nCopyright (c) 2012 Massive Interactive\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of \nthis software and associated documentation files (the \"Software\"), to deal in \nthe Software without restriction, including without limitation the rights to \nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \nof the Software, and to permit persons to whom the Software is furnished to do \nso, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all \ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \nSOFTWARE.\n*/\n\npackage msignal;\n\nimport msignal.Slot;\n\n/**\n\tA convenience type describing any kind of signal.\n**/\ntypedef AnySignal = Signal<Dynamic, Dynamic>;\n\n/**\n\tA Signal manages a list of listeners, which are executed when the signal is \n\tdispatched.\n**/\nclass Signal<TSlot:Slot<Dynamic, Dynamic>, TListener>\n{\n\tpublic var valueClasses:Array<Dynamic>;\n\n\t/**\n\t\tThe current number of listeners for the signal.\n\t**/\n\tpublic var numListeners(get_numListeners, null):Int;\n\t\n\tvar slots:SlotList<TSlot, TListener>;\n\tvar priorityBased:Bool;\n\n\tfunction new(?valueClasses:Array<Dynamic>)\n\t{\n\t\tif (valueClasses == null) valueClasses = [];\n\t\tthis.valueClasses = valueClasses;\n\t\tslots = cast SlotList.NIL;\n\t\tpriorityBased = false;\n\t}\n\n\t/**\n\t\tSubscribes a listener for the signal.\n\t\t\n\t\t@param listener A function matching the signature of TListener\n\t\t@return The added listener slot\n\t**/\n\tpublic function add(listener:TListener):TSlot\n\t{\n\t\treturn registerListener(listener);\n\t}\n\n\t/**\n\t\tSubscribes a one-time listener for this signal.\n\t\tThe signal will remove the listener automatically the first time it is called,\n\t\tafter the dispatch to all listeners is complete.\n\t\t\n\t\t@param listener A function matching the signature of TListener\n\t\t@return The added listener slot\n\t**/\n\tpublic function addOnce(listener:TListener):TSlot\n\t{\n\t\treturn registerListener(listener, true);\n\t}\n\n\t/**\n\t\tSubscribes a listener for the signal.\n\t\tAfter you successfully register an event listener,\n\t\tyou cannot change its priority through additional calls to add().\n\t\tTo change a listener's priority, you must first call remove().\n\t\tThen you can register the listener again with the new priority level.\n\t\t\n\t\t@param listener A function matching the signature of TListener\n\t\t@return The added listener slot\n\t**/\n\tpublic function addWithPriority(listener:TListener, ?priority:Int=0):TSlot\n\t{\n\t\treturn registerListener(listener, false, priority);\n\t}\n\n\t/**\n\t\tSubscribes a one-time listener for this signal.\n\t\tThe signal will remove the listener automatically the first time it is \n\t\tcalled, after the dispatch to all listeners is complete.\n\t\t\n\t\t@param listener A function matching the signature of TListener\n\t\t@return The added listener slot\n\t**/\n\tpublic function addOnceWithPriority(listener:TListener, ?priority:Int=0):TSlot\n\t{\n\t\treturn registerListener(listener, true, priority);\n\t}\n\n\t/**\n\t\tUnsubscribes a listener from the signal.\n\t\t\n\t\t@param listener The listener to remove\n\t\t@return The removed listener slot\n\t**/\n\tpublic function remove(listener:TListener):TSlot\n\t{\n\t\tvar slot = slots.find(listener);\n\t\tif (slot == null) return null;\n\t\t\n\t\tslots = slots.filterNot(listener);\n\t\treturn slot;\n\t}\n\n\t/**\n\t\tUnsubscribes all listeners from the signal.\n\t**/\n\tpublic function removeAll():Void\n\t{\n\t\tslots = cast SlotList.NIL;\n\t}\n\n\tfunction registerListener(listener:TListener, once:Bool=false, priority:Int=0):TSlot\n\t{\n\t\tif (registrationPossible(listener, once))\n\t\t{\n\t\t\tvar newSlot = createSlot(listener, once, priority);\n\t\t\t\n\t\t\tif (!priorityBased && priority != 0) priorityBased = true;\n\t\t\tif (!priorityBased && priority == 0) slots = slots.prepend(newSlot);\n\t\t\telse slots = slots.insertWithPriority(newSlot);\n\n\t\t\treturn newSlot;\n\t\t}\n\t\t\n\t\treturn slots.find(listener);\n\t}\n\n\tfunction registrationPossible(listener, once)\n\t{\n\t\tif (!slots.nonEmpty) return true;\n\t\t\n\t\tvar existingSlot = slots.find(listener);\n\t\tif (existingSlot == null) return true;\n\n\t\tif (existingSlot.once != once)\n\t\t{\n\t\t\t// If the listener was previously added, definitely don't add it again.\n\t\t\t// But throw an exception if their once values differ.\n\t\t\tthrow \"You cannot addOnce() then add() the same listener without removing the relationship first.\";\n\t\t}\n\t\t\n\t\treturn false; // Listener was already registered.\n\t}\n\n\t@:IgnoreCover\n\tfunction createSlot(listener:TListener, once:Bool=false, priority:Int=0):TSlot\n\t{\n\t\treturn null;\n\t}\n\n\tfunction get_numListeners()\n\t{\n\t\treturn slots.length;\n\t}\n}\n\n/**\n\tSignal that executes listeners with no arguments.\n**/\nclass Signal0 extends Signal<Slot0, Void -> Void>\n{\n\tpublic function new()\n\t{\n\t\tsuper();\n\t}\n\n\t/**\n\t\tExecutes the signals listeners with no arguements.\n\t**/\n\tpublic function dispatch()\n\t{\n\t\tvar slotsToProcess = slots;\n\t\t\n\t\twhile (slotsToProcess.nonEmpty)\n\t\t{\n\t\t\tslotsToProcess.head.execute();\n\t\t\tslotsToProcess = slotsToProcess.tail;\n\t\t}\n\t}\n\n\toverride function createSlot(listener:Void -> Void, once:Bool=false, priority:Int=0)\n\t{\n\t\treturn new Slot0(this, listener, once, priority);\n\t}\n}\n\n/**\n\tSignal that executes listeners with one arguments.\n**/\nclass Signal1<TValue> extends Signal<Slot1<TValue>, TValue -> Void>\n{\n\tpublic function new(?type:Dynamic=null)\n\t{\n\t\tsuper([type]);\n\t}\n\n\t/**\n\t\tExecutes the signals listeners with one arguement.\n\t**/\n\tpublic function dispatch(value:TValue)\n\t{\n\t\tvar slotsToProcess = slots;\n\t\t\n\t\twhile (slotsToProcess.nonEmpty)\n\t\t{\n\t\t\tslotsToProcess.head.execute(value);\n\t\t\tslotsToProcess = slotsToProcess.tail;\n\t\t}\n\t}\n\n\toverride function createSlot(listener:TValue -> Void, once:Bool=false, priority:Int=0)\n\t{\n\t\treturn new Slot1<TValue>(this, listener, once, priority);\n\t}\n}\n\n/**\n\tSignal that executes listeners with two arguments.\n**/\nclass Signal2<TValue1, TValue2> extends Signal<Slot2<TValue1, TValue2>, TValue1 -> TValue2 -> Void>\n{\n\tpublic function new(?type1:Dynamic=null, ?type2:Dynamic=null)\n\t{\n\t\tsuper([type1, type2]);\n\t}\n\n\t/**\n\t\tExecutes the signals listeners with two arguements.\n\t**/\n\tpublic function dispatch(value1:TValue1, value2:TValue2)\n\t{\n\t\tvar slotsToProcess = slots;\n\t\t\n\t\twhile (slotsToProcess.nonEmpty)\n\t\t{\n\t\t\tslotsToProcess.head.execute(value1, value2);\n\t\t\tslotsToProcess = slotsToProcess.tail;\n\t\t}\n\t}\n\n\toverride function createSlot(listener:TValue1 -> TValue2 -> Void, once:Bool=false, priority:Int=0)\n\t{\n\t\treturn new Slot2<TValue1, TValue2>(this, listener, once, priority);\n\t}\n}\n","/*\nCopyright (c) 2012 Massive Interactive\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of \nthis software and associated documentation files (the \"Software\"), to deal in \nthe Software without restriction, including without limitation the rights to \nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \nof the Software, and to permit persons to whom the Software is furnished to do \nso, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all \ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \nSOFTWARE.\n*/\n\npackage msignal;\n\nimport msignal.Signal;\n\n/**\n\tA convenience type describing any kind of slot.\n**/\ntypedef AnySlot = Slot<Dynamic, Dynamic>;\n\n/**\n\tDefines the basic properties of a listener associated with a Signal.\n**/\n#if haxe3\nclass Slot<TSignal:msignal.Signal.AnySignal, TListener>\n#else\nclass Slot<TSignal:Signal<Dynamic, TListener>, TListener>\n#end\n{\n\t/**\n\t\tThe listener associated with this slot.\n\t\tNote: for hxcpp 2.10 this requires a getter method to compile\n\t**/\n\t#if cpp\n\t#if haxe3 @:isVar #end\n\tpublic var listener(get_listener, set_listener):TListener;\n\t#else\n\t#if haxe3 @:isVar #end\n\tpublic var listener(default, set_listener):TListener;\n\t#end\n\t\n\n\t/**\n\t\tWhether this slot is automatically removed after it has been used once.\n\t**/\n\tpublic var once(default, null):Bool;\n\n\t/**\n\t\tThe priority of this slot should be given in the execution order.\n\t\tAn Signal will call higher numbers before lower ones.\n\t\tDefaults to 0.\n\t**/\n\tpublic var priority(default, null):Int;\n\n\t/**\n\t\tWhether the listener is called on execution. Defaults to true.\n\t**/\n\tpublic var enabled:Bool;\n\n\tvar signal:TSignal;\n\t\n\tfunction new(signal:TSignal, listener:TListener, once:Bool=false, priority:Int=0)\n\t{\n\t\tthis.signal = signal;\n\t\tthis.listener = listener;\n\t\tthis.once = once;\n\t\tthis.priority = priority;\n\t\tthis.enabled = true;\n\t}\n\n\t/**\n\t\tRemoves the slot from its signal.\n\t**/\n\tpublic function remove()\n\t{\n\t\tsignal.remove(listener);\n\t}\n\n\t#if cpp\n\t/**\n\t\tHxcpp 2.10 requires a getter method for a typed function property in \n\t\torder to compile\n\t**/\n\tfunction get_listener():TListener\n\t{\n\t\treturn listener;\n\t}\n\t#end\n\n\tfunction set_listener(value:TListener):TListener\n\t{\n\t\tif (value == null) throw \"listener cannot be null\";\n\t\treturn listener = value;\n\t}\n}\n\n/**\n\tA slot that executes a listener with no arguments.\n**/\nclass Slot0 extends Slot<Signal0, Void -> Void>\n{\n\tpublic function new(signal:Signal0, listener:Void -> Void, once:Bool=false, priority:Int=0)\n\t{\n\t\tsuper(signal, listener, once, priority);\n\t}\n\n\t/**\n\t\tExecutes a listener with no arguments.\n\t**/\n\tpublic function execute()\n\t{\n\t\tif (!enabled) return;\n\t\tif (once) remove();\n\t\tlistener();\n\t}\n}\n\n/**\n\tA slot that executes a listener with one argument.\n**/\nclass Slot1<TValue> extends Slot<Signal1<TValue>, TValue -> Void>\n{\n\t/**\n\t\tAllows the slot to inject the argument to dispatch.\n\t**/\n\tpublic var param:TValue;\n\n\tpublic function new(signal:Signal1<TValue>, listener:TValue -> Void, once:Bool=false, priority:Int=0)\n\t{\n\t\tsuper(signal, listener, once, priority);\n\t}\n\n\t/**\n\t\tExecutes a listener with one argument.\n\t\tIf <code>param</code> is not null, it overrides the value provided.\n\t**/\n\tpublic function execute(value1:TValue)\n\t{\n\t\tif (!enabled) return;\n\t\tif (once) remove();\n\t\tif (param != null) value1 = param;\n\t\tlistener(value1);\n\t}\n}\n\n/**\n\tA slot that executes a listener with two arguments.\n**/\nclass Slot2<TValue1, TValue2> extends Slot<Signal2<TValue1, TValue2>, TValue1 -> TValue2 -> Void>\n{\n\t/**\n\t\tAllows the slot to inject the first argument to dispatch.\n\t**/\n\tpublic var param1:TValue1;\n\n\t/**\n\t\tAllows the slot to inject the second argument to dispatch.\n\t**/\n\tpublic var param2:TValue2;\n\n\tpublic function new(signal:Signal2<TValue1, TValue2>, listener:TValue1 -> TValue2 -> Void, once:Bool=false, priority:Int=0)\n\t{\n\t\tsuper(signal, listener, once, priority);\n\t}\n\n\t/**\n\t\tExecutes a listener with two arguments.\n\t\tIf <code>param1</code> or <code>param2</code> is set, \n\t\tthey override the values provided.\n\t**/\n\tpublic function execute(value1:TValue1, value2:TValue2)\n\t{\n\t\tif (!enabled) return;\n\t\tif (once) remove();\n\t\t\n\t\tif (param1 != null) value1 = param1;\n\t\tif (param2 != null) value2 = param2;\n\t\t\n\t\tlistener(value1, value2);\n\t}\n}\n","/*\nCopyright (c) 2012 Massive Interactive\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of \nthis software and associated documentation files (the \"Software\"), to deal in \nthe Software without restriction, including without limitation the rights to \nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies \nof the Software, and to permit persons to whom the Software is furnished to do \nso, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all \ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR \nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, \nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE \nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER \nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, \nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE \nSOFTWARE.\n*/\n\npackage msignal;\n\nclass SlotList<TSlot:Slot<Dynamic, Dynamic>, TListener>\n{\n\t@:IgnoreCover\n\tstatic function __init__() { NIL = new SlotList<Dynamic, Dynamic>(null, null); }\n\t\n\t/**\n\t\tRepresents an empty list. Used as the list terminator.\n\t**/\n\tpublic static var NIL:SlotList<Dynamic, Dynamic>;\n\t\n\tpublic var head:TSlot;\n\tpublic var tail:SlotList<TSlot, TListener>;\n\tpublic var nonEmpty:Bool;\n\t\n\t/**\n\t\tCreates and returns a new SlotList object.\n\n\t\t<p>A user never has to create a SlotList manually. \n\t\tUse the <code>NIL</code> element to represent an empty list. \n\t\t<code>NIL.prepend(value)</code> would create a list containing \n\t\t<code>value</code></p>.\n\n\t\t@param head The first slot in the list.\n\t\t@param tail A list containing all slots except head.\n\t**/\n\tpublic function new(head:TSlot, tail:SlotList<TSlot, TListener>=null)\n\t{\n\t\tnonEmpty = false;\n\t\t\n\t\tif (head == null && tail == null)\n\t\t{\n\t\t\tif (NIL != null)\n\t\t\t{\n\t\t\t\tthrow \"Parameters head and tail are null. Use the NIL element instead.\";\n\t\t\t}\n\t\t\t\n\t\t\t// this is the NIL element as per definition\n\t\t\tnonEmpty = false;\n\t\t}\n\t\telse if (head == null)\n\t\t{\n\t\t\tthrow \"Parameter head cannot be null.\";\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.head = head;\n\t\t\tthis.tail = (tail == null ? cast NIL : tail);\n\t\t\tnonEmpty = true;\n\t\t}\n\t}\n\t\n\t/**\n\t\tThe number of slots in the list.\n\t**/\n\tpublic var length(get_length, null):Int;\n\tfunction get_length():Int\n\t{\n\t\tif (!nonEmpty) return 0;\n\t\tif (tail == NIL) return 1;\n\t\t\n\t\t// We could cache the length, but it would make methods like filterNot unnecessarily complicated.\n\t\t// Instead we assume that O(n) is okay since the length property is used in rare cases.\n\t\t// We could also cache the length lazy, but that is a waste of another 8b per list node (at least).\n\t\t\n\t\tvar result = 0;\n\t\tvar p = this;\n\t\t\n\t\twhile (p.nonEmpty)\n\t\t{\n\t\t\t++result;\n\t\t\tp = p.tail;\n\t\t}\n\t\t\n\t\treturn result;\n\t}\n\t\n\t/**\n\t\tPrepends a slot to this list.\n\t\t@param\tslot The item to be prepended.\n\t\t@return\tA list consisting of slot followed by all elements of this list.\n\t**/\n\tpublic function prepend(slot:TSlot)\n\t{\n\t\treturn new SlotList<TSlot, TListener>(slot, this);\n\t}\n\t\n\t/**\n\t\tAppends a slot to this list.\n\t\tNote: appending is O(n). Where possible, prepend which is O(1).\n\t\tIn some cases, many list items must be cloned to \n\t\tavoid changing existing lists.\n\t\t@param\tslot The item to be appended.\n\t\t@return\tA list consisting of all elements of this list followed by slot.\n\t**/\n\tpublic function append(slot:TSlot)\n\t{\n\t\tif (slot == null) return this;\n\t\tif (!nonEmpty) return new SlotList<TSlot, TListener>(slot);\n\t\t\n\t\t// Special case: just one slot currently in the list.\n\t\tif (tail == NIL) \n\t\t{\n\t\t\treturn new SlotList<TSlot, TListener>(slot).prepend(head);\n\t\t}\n\t\t\n\t\t// The list already has two or more slots.\n\t\t// We have to build a new list with cloned items because they are immutable.\n\t\tvar wholeClone = new SlotList<TSlot, TListener>(head);\n\t\tvar subClone = wholeClone;\n\t\tvar current = tail;\n\t\t\n\t\twhile (current.nonEmpty)\n\t\t{\n\t\t\tsubClone = subClone.tail = new SlotList<TSlot, TListener>(current.head);\n\t\t\tcurrent = current.tail;\n\t\t}\n\t\t\n\t\t// Append the new slot last.\n\t\tsubClone.tail = new SlotList<TSlot, TListener>(slot);\n\t\treturn wholeClone;\n\t}\t\t\n\t\n\t/**\n\t\tInsert a slot into the list in a position according to its priority.\n\t\tThe higher the priority, the closer the item will be inserted to the \n\t\tlist head.\n\t\t@param slot The item to be inserted.\n\t**/\n\tpublic function insertWithPriority(slot:TSlot)\n\t{\n\t\tif (!nonEmpty) return new SlotList<TSlot, TListener>(slot);\n\t\t\n\t\tvar priority:Int = slot.priority;\n\t\t\n\t\t// Special case: new slot has the highest priority.\n\t\tif (priority >= this.head.priority) return prepend(slot);\n\n\t\tvar wholeClone = new SlotList<TSlot, TListener>(head);\n\t\tvar subClone = wholeClone;\n\t\tvar current = tail;\n\n\t\t// Find a slot with lower priority and go in front of it.\n\t\twhile (current.nonEmpty)\n\t\t{\n\t\t\tif (priority > current.head.priority)\n\t\t\t{\n\t\t\t\tsubClone.tail = current.prepend(slot);\n\t\t\t\treturn wholeClone;\n\t\t\t}\n\t\t\t\n\t\t\tsubClone = subClone.tail = new SlotList<TSlot, TListener>(current.head);\n\t\t\tcurrent = current.tail;\n\t\t}\n\t\t\n\t\t// Slot has lowest priority.\n\t\tsubClone.tail = new SlotList<TSlot, TListener>(slot);\n\t\treturn wholeClone;\n\t}\n\t\n\t/**\n\t\tReturns the slots in this list that do not contain the supplied \n\t\tlistener. Note: assumes the listener is not repeated within the list.\n\t\t@param\tlistener The function to remove.\n\t\t@return A list consisting of all elements of this list that do not \n\t\t\t\thave listener.\n\t**/\n\tpublic function filterNot(listener:TListener)\n\t{\n\t\tif (!nonEmpty || listener == null) return this;\n\t\t\n\t\tif (Reflect.compareMethods(head.listener, listener)) return tail;\n\t\t\n\t\t// The first item wasn't a match so the filtered list will contain it.\n\t\tvar wholeClone = new SlotList<TSlot, TListener>(head);\n\t\tvar subClone = wholeClone;\n\t\tvar current = tail;\n\t\t\n\t\twhile (current.nonEmpty)\n\t\t{\n\t\t\tif (Reflect.compareMethods(current.head.listener, listener))\n\t\t\t{\n\t\t\t\t// Splice out the current head.\n\t\t\t\tsubClone.tail = current.tail;\n\t\t\t\treturn wholeClone;\n\t\t\t}\n\t\t\t\n\t\t\tsubClone = subClone.tail = new SlotList<TSlot, TListener>(current.head);\n\t\t\tcurrent = current.tail;\n\t\t}\n\t\t\n\t\t// The listener was not found so this list is unchanged.\n\t\treturn this;\n\t}\n\t\n\t/**\n\t\tDetermines whether the supplied listener Function is contained \n\t\twithin this list\n\t**/\n\tpublic function contains(listener:TListener):Bool\n\t{\n\t\tif (!nonEmpty) return false;\n\n\t\tvar p = this;\n\t\twhile (p.nonEmpty)\n\t\t{\n\t\t\tif (Reflect.compareMethods(p.head.listener, listener)) return true;\n\t\t\tp = p.tail;\n\t\t}\n\n\t\treturn false;\n\t}\n\t\n\t/**\n\t\tRetrieves the Slot associated with a supplied listener within the SlotList.\n\t\t@param   listener The Function being searched for\n\t\t@return  The ISlot in this list associated with the listener parameter \n\t\t\t\t through the ISlot.listener property. Returns null if no such \n\t\t\t\t ISlot instance exists or the list is empty.  \n\t**/\n\tpublic function find(listener:TListener):TSlot\n\t{\n\t\tif (!nonEmpty) return null;\n\t\t\n\t\tvar p = this;\n\t\twhile (p.nonEmpty)\n\t\t{\n\t\t\tif (Reflect.compareMethods(p.head.listener, listener)) return p.head;\n\t\t\tp = p.tail;\n\t\t}\n\t\t\n\t\treturn null;\n\t}\n}\n"],
"names":[],
"mappings":"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"
}